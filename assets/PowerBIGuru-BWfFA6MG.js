import{c as N,u as os,b as is,r as h,j as t,d as xe,T as nt,A as Y,m as O,e as at,a as rs}from"./index-CzjZnGvN.js";import{C as pe}from"./copy-lP8WdEaY.js";import{T as ge}from"./type-DPjx6cs7.js";import{D as ot}from"./download-jbadH7Mx.js";import{D as it}from"./database-DpmOJEce.js";import{S as rt,K as ls}from"./send-c8SLL2Tt.js";import{C as cs}from"./chevron-down-Du4HuCkB.js";const ds=[["path",{d:"M12 17V3",key:"1cwfxf"}],["path",{d:"m6 11 6 6 6-6",key:"12ii2o"}],["path",{d:"M19 21H5",key:"150jfl"}]],us=N("arrow-down-to-line",ds);const hs=[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}],["line",{x1:"12",x2:"12",y1:"7",y2:"13",key:"1cppfj"}],["line",{x1:"15",x2:"9",y1:"10",y2:"10",key:"1gty7f"}]],_e=N("bookmark-plus",hs);const ms=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],lt=N("bot",ms);const fs=[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21",key:"g5wo59"}],["path",{d:"m5.082 11.09 8.828 8.828",key:"1wx5vj"}]],xs=N("eraser",fs);const ps=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],ct=N("grip-vertical",ps);const gs=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],bs=N("maximize-2",gs);const ys=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],ws=N("message-square",ys);const vs=[["path",{d:"m14 10 7-7",key:"oa77jy"}],["path",{d:"M20 10h-6V4",key:"mjg0md"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M4 14h6v6",key:"rmj7iw"}]],Ns=N("minimize-2",vs);const Cs=[["path",{d:"M13.4 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-7.4",key:"re6nr2"}],["path",{d:"M2 6h4",key:"aawbzj"}],["path",{d:"M2 10h4",key:"l0bgd4"}],["path",{d:"M2 14h4",key:"1gsvsf"}],["path",{d:"M2 18h4",key:"1bu2t1"}],["path",{d:"M21.378 5.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"pqwjuv"}]],Es=N("notebook-pen",Cs);const Ss=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"m16 15-3-3 3-3",key:"14y99z"}]],dt=N("panel-left-close",Ss);const js=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"m14 9 3 3-3 3",key:"8010ee"}]],ut=N("panel-left-open",js);const Is=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M15 3v18",key:"14nvp0"}],["path",{d:"m8 9 3 3-3 3",key:"12hl5m"}]],ht=N("panel-right-close",Is);const _s=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M15 3v18",key:"14nvp0"}],["path",{d:"m10 15-3-3 3-3",key:"1pgupc"}]],mt=N("panel-right-open",_s);const As=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],ks=N("settings",As);const Rs=[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]],ft=N("wand-sparkles",Rs);var xt;(function(e){e.STRING="string",e.NUMBER="number",e.INTEGER="integer",e.BOOLEAN="boolean",e.ARRAY="array",e.OBJECT="object"})(xt||(xt={}));var pt;(function(e){e.LANGUAGE_UNSPECIFIED="language_unspecified",e.PYTHON="python"})(pt||(pt={}));var gt;(function(e){e.OUTCOME_UNSPECIFIED="outcome_unspecified",e.OUTCOME_OK="outcome_ok",e.OUTCOME_FAILED="outcome_failed",e.OUTCOME_DEADLINE_EXCEEDED="outcome_deadline_exceeded"})(gt||(gt={}));const bt=["user","model","function","system"];var yt;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(yt||(yt={}));var wt;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(wt||(wt={}));var vt;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(vt||(vt={}));var Nt;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER"})(Nt||(Nt={}));var se;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.OTHER="OTHER"})(se||(se={}));var Ct;(function(e){e.TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",e.RETRIEVAL_QUERY="RETRIEVAL_QUERY",e.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",e.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",e.CLASSIFICATION="CLASSIFICATION",e.CLUSTERING="CLUSTERING"})(Ct||(Ct={}));var Et;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE"})(Et||(Et={}));var St;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(St||(St={}));class v extends Error{constructor(n){super(`[GoogleGenerativeAI Error]: ${n}`)}}class z extends v{constructor(n,a){super(n),this.response=a}}class Ht extends v{constructor(n,a,o,i){super(n),this.status=a,this.statusText=o,this.errorDetails=i}}class M extends v{}class Gt extends v{}const Os="https://generativelanguage.googleapis.com",Ts="v1beta",Ms="0.24.1",Ds="genai-js";var P;(function(e){e.GENERATE_CONTENT="generateContent",e.STREAM_GENERATE_CONTENT="streamGenerateContent",e.COUNT_TOKENS="countTokens",e.EMBED_CONTENT="embedContent",e.BATCH_EMBED_CONTENTS="batchEmbedContents"})(P||(P={}));class Ls{constructor(n,a,o,i,r){this.model=n,this.task=a,this.apiKey=o,this.stream=i,this.requestOptions=r}toString(){var n,a;const o=((n=this.requestOptions)===null||n===void 0?void 0:n.apiVersion)||Ts;let r=`${((a=this.requestOptions)===null||a===void 0?void 0:a.baseUrl)||Os}/${o}/${this.model}:${this.task}`;return this.stream&&(r+="?alt=sse"),r}}function $s(e){const n=[];return e?.apiClient&&n.push(e.apiClient),n.push(`${Ds}/${Ms}`),n.join(" ")}async function Hs(e){var n;const a=new Headers;a.append("Content-Type","application/json"),a.append("x-goog-api-client",$s(e.requestOptions)),a.append("x-goog-api-key",e.apiKey);let o=(n=e.requestOptions)===null||n===void 0?void 0:n.customHeaders;if(o){if(!(o instanceof Headers))try{o=new Headers(o)}catch(i){throw new M(`unable to convert customHeaders value ${JSON.stringify(o)} to Headers: ${i.message}`)}for(const[i,r]of o.entries()){if(i==="x-goog-api-key")throw new M(`Cannot set reserved header name ${i}`);if(i==="x-goog-api-client")throw new M(`Header name ${i} can only be set using the apiClient field`);a.append(i,r)}}return a}async function Gs(e,n,a,o,i,r){const l=new Ls(e,n,a,o,r);return{url:l.toString(),fetchOptions:Object.assign(Object.assign({},Fs(r)),{method:"POST",headers:await Hs(l),body:i})}}async function oe(e,n,a,o,i,r={},l=fetch){const{url:d,fetchOptions:f}=await Gs(e,n,a,o,i,r);return Us(d,f,l)}async function Us(e,n,a=fetch){let o;try{o=await a(e,n)}catch(i){Ps(i,e)}return o.ok||await Ks(o,e),o}function Ps(e,n){let a=e;throw a.name==="AbortError"?(a=new Gt(`Request aborted when fetching ${n.toString()}: ${e.message}`),a.stack=e.stack):e instanceof Ht||e instanceof M||(a=new v(`Error fetching from ${n.toString()}: ${e.message}`),a.stack=e.stack),a}async function Ks(e,n){let a="",o;try{const i=await e.json();a=i.error.message,i.error.details&&(a+=` ${JSON.stringify(i.error.details)}`,o=i.error.details)}catch{}throw new Ht(`Error fetching from ${n.toString()}: [${e.status} ${e.statusText}] ${a}`,e.status,e.statusText,o)}function Fs(e){const n={};if(e?.signal!==void 0||e?.timeout>=0){const a=new AbortController;e?.timeout>=0&&setTimeout(()=>a.abort(),e.timeout),e?.signal&&e.signal.addEventListener("abort",()=>{a.abort()}),n.signal=a.signal}return n}function ke(e){return e.text=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`),we(e.candidates[0]))throw new z(`${T(e)}`,e);return Bs(e)}else if(e.promptFeedback)throw new z(`Text not available. ${T(e)}`,e);return""},e.functionCall=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),we(e.candidates[0]))throw new z(`${T(e)}`,e);return console.warn("response.functionCall() is deprecated. Use response.functionCalls() instead."),jt(e)[0]}else if(e.promptFeedback)throw new z(`Function call not available. ${T(e)}`,e)},e.functionCalls=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),we(e.candidates[0]))throw new z(`${T(e)}`,e);return jt(e)}else if(e.promptFeedback)throw new z(`Function call not available. ${T(e)}`,e)},e}function Bs(e){var n,a,o,i;const r=[];if(!((a=(n=e.candidates)===null||n===void 0?void 0:n[0].content)===null||a===void 0)&&a.parts)for(const l of(i=(o=e.candidates)===null||o===void 0?void 0:o[0].content)===null||i===void 0?void 0:i.parts)l.text&&r.push(l.text),l.executableCode&&r.push("\n```"+l.executableCode.language+`
`+l.executableCode.code+"\n```\n"),l.codeExecutionResult&&r.push("\n```\n"+l.codeExecutionResult.output+"\n```\n");return r.length>0?r.join(""):""}function jt(e){var n,a,o,i;const r=[];if(!((a=(n=e.candidates)===null||n===void 0?void 0:n[0].content)===null||a===void 0)&&a.parts)for(const l of(i=(o=e.candidates)===null||o===void 0?void 0:o[0].content)===null||i===void 0?void 0:i.parts)l.functionCall&&r.push(l.functionCall);if(r.length>0)return r}const Ys=[se.RECITATION,se.SAFETY,se.LANGUAGE];function we(e){return!!e.finishReason&&Ys.includes(e.finishReason)}function T(e){var n,a,o;let i="";if((!e.candidates||e.candidates.length===0)&&e.promptFeedback)i+="Response was blocked",!((n=e.promptFeedback)===null||n===void 0)&&n.blockReason&&(i+=` due to ${e.promptFeedback.blockReason}`),!((a=e.promptFeedback)===null||a===void 0)&&a.blockReasonMessage&&(i+=`: ${e.promptFeedback.blockReasonMessage}`);else if(!((o=e.candidates)===null||o===void 0)&&o[0]){const r=e.candidates[0];we(r)&&(i+=`Candidate was blocked due to ${r.finishReason}`,r.finishMessage&&(i+=`: ${r.finishMessage}`))}return i}function ne(e){return this instanceof ne?(this.v=e,this):new ne(e)}function zs(e,n,a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o=a.apply(e,n||[]),i,r=[];return i={},l("next"),l("throw"),l("return"),i[Symbol.asyncIterator]=function(){return this},i;function l(p){o[p]&&(i[p]=function(g){return new Promise(function(y,k){r.push([p,g,y,k])>1||d(p,g)})})}function d(p,g){try{f(o[p](g))}catch(y){I(r[0][3],y)}}function f(p){p.value instanceof ne?Promise.resolve(p.value.v).then(E,A):I(r[0][2],p)}function E(p){d("next",p)}function A(p){d("throw",p)}function I(p,g){p(g),r.shift(),r.length&&d(r[0][0],r[0][1])}}const It=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;function qs(e){const n=e.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0})),a=Xs(n),[o,i]=a.tee();return{stream:Ws(o),response:Vs(i)}}async function Vs(e){const n=[],a=e.getReader();for(;;){const{done:o,value:i}=await a.read();if(o)return ke(Js(n));n.push(i)}}function Ws(e){return zs(this,arguments,function*(){const a=e.getReader();for(;;){const{value:o,done:i}=yield ne(a.read());if(i)break;yield yield ne(ke(o))}})}function Xs(e){const n=e.getReader();return new ReadableStream({start(o){let i="";return r();function r(){return n.read().then(({value:l,done:d})=>{if(d){if(i.trim()){o.error(new v("Failed to parse stream"));return}o.close();return}i+=l;let f=i.match(It),E;for(;f;){try{E=JSON.parse(f[1])}catch{o.error(new v(`Error parsing JSON response: "${f[1]}"`));return}o.enqueue(E),i=i.substring(f[0].length),f=i.match(It)}return r()}).catch(l=>{let d=l;throw d.stack=l.stack,d.name==="AbortError"?d=new Gt("Request aborted when reading from the stream"):d=new v("Error reading from the stream"),d})}}})}function Js(e){const n=e[e.length-1],a={promptFeedback:n?.promptFeedback};for(const o of e){if(o.candidates){let i=0;for(const r of o.candidates)if(a.candidates||(a.candidates=[]),a.candidates[i]||(a.candidates[i]={index:i}),a.candidates[i].citationMetadata=r.citationMetadata,a.candidates[i].groundingMetadata=r.groundingMetadata,a.candidates[i].finishReason=r.finishReason,a.candidates[i].finishMessage=r.finishMessage,a.candidates[i].safetyRatings=r.safetyRatings,r.content&&r.content.parts){a.candidates[i].content||(a.candidates[i].content={role:r.content.role||"user",parts:[]});const l={};for(const d of r.content.parts)d.text&&(l.text=d.text),d.functionCall&&(l.functionCall=d.functionCall),d.executableCode&&(l.executableCode=d.executableCode),d.codeExecutionResult&&(l.codeExecutionResult=d.codeExecutionResult),Object.keys(l).length===0&&(l.text=""),a.candidates[i].content.parts.push(l)}i++}o.usageMetadata&&(a.usageMetadata=o.usageMetadata)}return a}async function Ut(e,n,a,o){const i=await oe(n,P.STREAM_GENERATE_CONTENT,e,!0,JSON.stringify(a),o);return qs(i)}async function Pt(e,n,a,o){const r=await(await oe(n,P.GENERATE_CONTENT,e,!1,JSON.stringify(a),o)).json();return{response:ke(r)}}function Kt(e){if(e!=null){if(typeof e=="string")return{role:"system",parts:[{text:e}]};if(e.text)return{role:"system",parts:[e]};if(e.parts)return e.role?e:{role:"system",parts:e.parts}}}function ae(e){let n=[];if(typeof e=="string")n=[{text:e}];else for(const a of e)typeof a=="string"?n.push({text:a}):n.push(a);return Qs(n)}function Qs(e){const n={role:"user",parts:[]},a={role:"function",parts:[]};let o=!1,i=!1;for(const r of e)"functionResponse"in r?(a.parts.push(r),i=!0):(n.parts.push(r),o=!0);if(o&&i)throw new v("Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.");if(!o&&!i)throw new v("No content is provided for sending chat message.");return o?n:a}function Zs(e,n){var a;let o={model:n?.model,generationConfig:n?.generationConfig,safetySettings:n?.safetySettings,tools:n?.tools,toolConfig:n?.toolConfig,systemInstruction:n?.systemInstruction,cachedContent:(a=n?.cachedContent)===null||a===void 0?void 0:a.name,contents:[]};const i=e.generateContentRequest!=null;if(e.contents){if(i)throw new M("CountTokensRequest must have one of contents or generateContentRequest, not both.");o.contents=e.contents}else if(i)o=Object.assign(Object.assign({},o),e.generateContentRequest);else{const r=ae(e);o.contents=[r]}return{generateContentRequest:o}}function _t(e){let n;return e.contents?n=e:n={contents:[ae(e)]},e.systemInstruction&&(n.systemInstruction=Kt(e.systemInstruction)),n}function en(e){return typeof e=="string"||Array.isArray(e)?{content:ae(e)}:e}const At=["text","inlineData","functionCall","functionResponse","executableCode","codeExecutionResult"],tn={user:["text","inlineData"],function:["functionResponse"],model:["text","functionCall","executableCode","codeExecutionResult"],system:["text"]};function sn(e){let n=!1;for(const a of e){const{role:o,parts:i}=a;if(!n&&o!=="user")throw new v(`First content should be with role 'user', got ${o}`);if(!bt.includes(o))throw new v(`Each item should include role field. Got ${o} but valid roles are: ${JSON.stringify(bt)}`);if(!Array.isArray(i))throw new v("Content should have 'parts' property with an array of Parts");if(i.length===0)throw new v("Each Content should have at least one part");const r={text:0,inlineData:0,functionCall:0,functionResponse:0,fileData:0,executableCode:0,codeExecutionResult:0};for(const d of i)for(const f of At)f in d&&(r[f]+=1);const l=tn[o];for(const d of At)if(!l.includes(d)&&r[d]>0)throw new v(`Content with role '${o}' can't contain '${d}' part`);n=!0}}function kt(e){var n;if(e.candidates===void 0||e.candidates.length===0)return!1;const a=(n=e.candidates[0])===null||n===void 0?void 0:n.content;if(a===void 0||a.parts===void 0||a.parts.length===0)return!1;for(const o of a.parts)if(o===void 0||Object.keys(o).length===0||o.text!==void 0&&o.text==="")return!1;return!0}const Rt="SILENT_ERROR";class nn{constructor(n,a,o,i={}){this.model=a,this.params=o,this._requestOptions=i,this._history=[],this._sendPromise=Promise.resolve(),this._apiKey=n,o?.history&&(sn(o.history),this._history=o.history)}async getHistory(){return await this._sendPromise,this._history}async sendMessage(n,a={}){var o,i,r,l,d,f;await this._sendPromise;const E=ae(n),A={safetySettings:(o=this.params)===null||o===void 0?void 0:o.safetySettings,generationConfig:(i=this.params)===null||i===void 0?void 0:i.generationConfig,tools:(r=this.params)===null||r===void 0?void 0:r.tools,toolConfig:(l=this.params)===null||l===void 0?void 0:l.toolConfig,systemInstruction:(d=this.params)===null||d===void 0?void 0:d.systemInstruction,cachedContent:(f=this.params)===null||f===void 0?void 0:f.cachedContent,contents:[...this._history,E]},I=Object.assign(Object.assign({},this._requestOptions),a);let p;return this._sendPromise=this._sendPromise.then(()=>Pt(this._apiKey,this.model,A,I)).then(g=>{var y;if(kt(g.response)){this._history.push(E);const k=Object.assign({parts:[],role:"model"},(y=g.response.candidates)===null||y===void 0?void 0:y[0].content);this._history.push(k)}else{const k=T(g.response);k&&console.warn(`sendMessage() was unsuccessful. ${k}. Inspect response object for details.`)}p=g}).catch(g=>{throw this._sendPromise=Promise.resolve(),g}),await this._sendPromise,p}async sendMessageStream(n,a={}){var o,i,r,l,d,f;await this._sendPromise;const E=ae(n),A={safetySettings:(o=this.params)===null||o===void 0?void 0:o.safetySettings,generationConfig:(i=this.params)===null||i===void 0?void 0:i.generationConfig,tools:(r=this.params)===null||r===void 0?void 0:r.tools,toolConfig:(l=this.params)===null||l===void 0?void 0:l.toolConfig,systemInstruction:(d=this.params)===null||d===void 0?void 0:d.systemInstruction,cachedContent:(f=this.params)===null||f===void 0?void 0:f.cachedContent,contents:[...this._history,E]},I=Object.assign(Object.assign({},this._requestOptions),a),p=Ut(this._apiKey,this.model,A,I);return this._sendPromise=this._sendPromise.then(()=>p).catch(g=>{throw new Error(Rt)}).then(g=>g.response).then(g=>{if(kt(g)){this._history.push(E);const y=Object.assign({},g.candidates[0].content);y.role||(y.role="model"),this._history.push(y)}else{const y=T(g);y&&console.warn(`sendMessageStream() was unsuccessful. ${y}. Inspect response object for details.`)}}).catch(g=>{g.message!==Rt&&console.error(g)}),p}}async function an(e,n,a,o){return(await oe(n,P.COUNT_TOKENS,e,!1,JSON.stringify(a),o)).json()}async function on(e,n,a,o){return(await oe(n,P.EMBED_CONTENT,e,!1,JSON.stringify(a),o)).json()}async function rn(e,n,a,o){const i=a.requests.map(l=>Object.assign(Object.assign({},l),{model:n}));return(await oe(n,P.BATCH_EMBED_CONTENTS,e,!1,JSON.stringify({requests:i}),o)).json()}class Ot{constructor(n,a,o={}){this.apiKey=n,this._requestOptions=o,a.model.includes("/")?this.model=a.model:this.model=`models/${a.model}`,this.generationConfig=a.generationConfig||{},this.safetySettings=a.safetySettings||[],this.tools=a.tools,this.toolConfig=a.toolConfig,this.systemInstruction=Kt(a.systemInstruction),this.cachedContent=a.cachedContent}async generateContent(n,a={}){var o;const i=_t(n),r=Object.assign(Object.assign({},this._requestOptions),a);return Pt(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(o=this.cachedContent)===null||o===void 0?void 0:o.name},i),r)}async generateContentStream(n,a={}){var o;const i=_t(n),r=Object.assign(Object.assign({},this._requestOptions),a);return Ut(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(o=this.cachedContent)===null||o===void 0?void 0:o.name},i),r)}startChat(n){var a;return new nn(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(a=this.cachedContent)===null||a===void 0?void 0:a.name},n),this._requestOptions)}async countTokens(n,a={}){const o=Zs(n,{model:this.model,generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:this.cachedContent}),i=Object.assign(Object.assign({},this._requestOptions),a);return an(this.apiKey,this.model,o,i)}async embedContent(n,a={}){const o=en(n),i=Object.assign(Object.assign({},this._requestOptions),a);return on(this.apiKey,this.model,o,i)}async batchEmbedContents(n,a={}){const o=Object.assign(Object.assign({},this._requestOptions),a);return rn(this.apiKey,this.model,n,o)}}class ln{constructor(n){this.apiKey=n}getGenerativeModel(n,a){if(!n.model)throw new v("Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })");return new Ot(this.apiKey,n,a)}getGenerativeModelFromCachedContent(n,a,o){if(!n.name)throw new M("Cached content must contain a `name` field.");if(!n.model)throw new M("Cached content must contain a `model` field.");const i=["model","systemInstruction"];for(const l of i)if(a?.[l]&&n[l]&&a?.[l]!==n[l]){if(l==="model"){const d=a.model.startsWith("models/")?a.model.replace("models/",""):a.model,f=n.model.startsWith("models/")?n.model.replace("models/",""):n.model;if(d===f)continue}throw new M(`Different value for "${l}" specified in modelParams (${a[l]}) and cachedContent (${n[l]})`)}const r=Object.assign(Object.assign({},a),{model:n.model,tools:n.tools,toolConfig:n.toolConfig,systemInstruction:n.systemInstruction,cachedContent:n});return new Ot(this.apiKey,r,o)}}const cn=[{keywords:["yoy","year over year","growth"],answer:"For Year-over-Year growth, use the 'YoY Growth %' pattern in the DAX Library. It uses `SAMEPERIODLASTYEAR`.",link:"/dax"},{keywords:["blue","color","hex","brand"],answer:"The official HHS Blue hex code is #005EA2. You can find the full palette in the Style Guide.",link:"/style-guide"},{keywords:["pareto","80/20"],answer:"We have a Pareto Analysis pattern in the DAX Library under 'Advanced Analytics'.",link:"/dax"},{keywords:["font","typography"],answer:"The approved font is 'Source Sans Pro'. See the Style Guide for heading sizes.",link:"/style-guide"},{keywords:["dax","measure","calculation"],answer:"The DAX Library contains patterns for Time Intelligence, Financial Formulas, and more. Check the 'DAX Library' tab.",link:"/dax"}],ee=180,Ae=4e3,dn=280,te=(e,n,a)=>Math.min(Math.max(e,n),a),un=()=>typeof window>"u"?360:te(window.innerWidth*.3,ee,Ae),be=()=>({id:"welcome",text:"Hi, I'm your Analytics Assistant. Ask me about DAX, HHS Branding, or data strategy.",sender:"bot",isSystem:!0,createdAt:new Date().toISOString()}),Tt=[{label:"Generate DAX",value:"Create a reusable DAX measure for year-over-year revenue with clear comments."},{label:"Explain Visual",value:"Explain how to design an executive KPI card for Power BI with HHS branding guidance."},{label:"Build Checklist",value:"Give me a pre-publish checklist for a Power BI report destined for leadership review."},{label:"Debug Measure",value:"Help me troubleshoot why my DAX measure is returning blank values."}],Mt="guru_session_notes",Dt="guru_messages",Lt="guru_font_size",$t="guru_line_height",q={small:{label:"Small",message:"text-xs",meta:"text-[10px]",code:"text-xs",description:"Compact"},medium:{label:"Medium",message:"text-sm",meta:"text-xs",code:"text-sm",description:"Default"},large:{label:"Large",message:"text-base",meta:"text-sm",code:"text-base",description:"Comfortable"},xlarge:{label:"Extra Large",message:"text-lg",meta:"text-sm",code:"text-base",description:"Accessibility"}},ye={normal:{label:"Normal",class:"leading-normal"},relaxed:{label:"Relaxed",class:"leading-relaxed"},loose:{label:"Loose",class:"leading-loose"}},Ft=["gemini-2.5-flash","gemini-2.0-flash","gemini-1.5-flash","gemini-pro"],hn=["v1beta","v1"],mn=Ft[0],ve="AIzaSyDwiE6kUBveR6ncuUlphCbdK2EGqeLnMXY".trim()||"",fn=()=>{if(typeof window>"u")return"";const e=window.localStorage.getItem("gemini_api_key");return e?e.trim():""},xn=()=>{const e=fn();return e?{key:e,source:"custom"}:ve?{key:ve,source:"project"}:{key:"",source:"none"}},pn=(e,n=120)=>e?e.length>n?`${e.slice(0,n)}…`:e:"",jn=()=>{const{addToast:e}=os(),{isSidebarCollapsed:n,toggleSidebar:a}=is(),o=h.useRef(xn()),[i,r]=h.useState(()=>{if(typeof window>"u")return[be()];try{const s=window.localStorage.getItem(Dt);return s?JSON.parse(s):[be()]}catch(s){return console.error("Failed to parse messages",s),[be()]}}),[l,d]=h.useState(""),[f,E]=h.useState(o.current.key),[A,I]=h.useState(o.current.source==="custom"?o.current.key:""),[p,g]=h.useState(o.current.source==="custom"),[y,k]=h.useState(!1),[ie,re]=h.useState(!1),[le,D]=h.useState(o.current.key?"connecting":"idle"),[Bt,L]=h.useState(""),[Re,ce]=h.useState(null),de=h.useRef(null),Ne=h.useRef(null),[Yt,zt]=h.useState(!0),V=h.useRef(null),R=h.useRef(null),[Oe,Ce]=h.useState(()=>un()),[S,qt]=h.useState(!1),[W,Vt]=h.useState(()=>typeof window>"u"?!1:window.innerWidth>=1024),[$,Ee]=h.useState(()=>typeof window>"u"?"":window.localStorage.getItem(Mt)||""),[X,Wt]=h.useState(!1),[Te,Xt]=h.useState(!1),[H,Me]=h.useState(null),[ue,J]=h.useState(null),[K,De]=h.useState(()=>typeof window>"u"?"medium":window.localStorage.getItem(Lt)||"medium"),[Q,Le]=h.useState(()=>typeof window>"u"?"relaxed":window.localStorage.getItem($t)||"relaxed"),[F,$e]=h.useState(!1),he=h.useCallback(()=>{if(!R.current||typeof window>"u")return Ae;const s=window.getComputedStyle(R.current),c=parseFloat(s.columnGap||s.gap||"0")||0,u=R.current.getBoundingClientRect().width-c-dn;return te(u,ee,Ae)},[R]),G=h.useCallback(()=>{if(typeof window>"u")return;const s=window.innerWidth>=1024;if(Vt(s),!s)return;const c=he();Ce(x=>te(x,ee,c))},[he]);h.useEffect(()=>{},[]),h.useEffect(()=>{if(G(),!(typeof window>"u"))return window.addEventListener("resize",G),()=>window.removeEventListener("resize",G)},[G]),h.useEffect(()=>{G()},[Te,G]),h.useEffect(()=>{typeof window>"u"||window.localStorage.setItem(Dt,JSON.stringify(i))},[i]);const He=s=>{if(!s)return;const c=document.getElementById(`message-${s}`);c&&c.scrollIntoView({behavior:"smooth",block:"start"})};h.useEffect(()=>{const s=i[i.length-1];if(s?.sender==="bot"&&!s.isSystem&&H?.id){He(H.id);return}de.current?.scrollIntoView({behavior:"smooth"})},[i,H]),h.useEffect(()=>{const s=Ne.current;if(!s)return;const c=()=>{const{scrollTop:x,scrollHeight:u,clientHeight:m}=s,b=x+m>=u-10;zt(b)};return s.addEventListener("scroll",c),c(),()=>s.removeEventListener("scroll",c)},[i]);const Ge=()=>{de.current?.scrollIntoView({behavior:"smooth"})};h.useEffect(()=>{typeof window>"u"||window.localStorage.setItem(Mt,$)},[$]),h.useEffect(()=>{typeof window>"u"||window.localStorage.setItem(Lt,K)},[K]),h.useEffect(()=>{typeof window>"u"||window.localStorage.setItem($t,Q)},[Q]),h.useEffect(()=>{if(!V.current)return;const s=V.current;s.style.height="auto";const c=200;s.style.height=`${Math.min(s.scrollHeight,c)}px`},[l]),h.useEffect(()=>{const s=f.trim();if(!s){D("idle"),L(""),ce(null);return}let c=!1;const x=new AbortController;return(async()=>{D("connecting"),L(""),ce(null);for(const m of hn)try{const b=await fetch(`https://generativelanguage.googleapis.com/${m}/models/${encodeURIComponent(mn)}?key=${encodeURIComponent(s)}`,{signal:x.signal});if(!b.ok){const C=await b.json().catch(()=>({})),w=C?.error?.message||"Unable to verify access code";if(b.status===404||C?.error?.status==="NOT_FOUND")continue;throw new Error(w)}if(c)return;D("connected"),L(""),ce(m);return}catch{if(x.signal.aborted||c)return;break}D("idle"),L(""),ce(null)})(),()=>{c=!0,x.abort()}},[f]);const Jt=()=>{const s=A.trim();if(!s){e("Please enter a valid access code","error");return}typeof window<"u"&&window.localStorage.setItem("gemini_api_key",s),g(!0),E(s),I(""),D("connecting"),L(""),k(!1),e("Personal access code saved. Connecting now...","success")},Qt=()=>{typeof window<"u"&&window.localStorage.removeItem("gemini_api_key");const s=ve||"";g(!1),I(""),E(s),D(s?"connecting":"idle"),L(""),e(s?"Reverted to the built-in HHS access code.":"Access code removed. Running in local knowledge mode.","info")},Zt=s=>{const c=s.toLowerCase();return cn.find(x=>x.keywords.some(u=>c.includes(u)))},Se=async s=>{if(s)try{if(typeof navigator>"u"||!navigator.clipboard)throw new Error("Clipboard unavailable");await navigator.clipboard.writeText(s),e("Message copied to clipboard","success")}catch(c){console.error("Copy failed",c),e("Unable to copy message","error")}},Ue=()=>{confirm("Clear this conversation and start fresh?")&&(r([be()]),e("Conversation cleared","success"),Ge(),Me(null),J(null))},Pe=()=>{const s=i.filter(m=>!m.isSystem).map(m=>`${m.sender.toUpperCase()} (${Z(m,!0)}):
${m.text}`).join(`

---

`),c=new Blob([s],{type:"text/plain"}),x=URL.createObjectURL(c),u=document.createElement("a");u.href=x,u.download=`power-bi-guru-chat-${new Date().toISOString().split("T")[0]}.txt`,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(x),e("Chat exported","success")},Ke=s=>{d(s),V.current?.focus()},es=async()=>{if(!$.trim()){e("No notes to copy","info");return}try{await navigator.clipboard.writeText($),e("Session notes copied","success")}catch(s){console.error("Copy notes failed",s),e("Unable to copy notes","error")}},ts=()=>{$.trim()&&confirm("Clear session notes?")&&(Ee(""),e("Session notes cleared","success"))},Fe=s=>{if(!W||S||!R.current)return;s.preventDefault();const c=s.clientX,x=Oe,u=document.body.style.userSelect;document.body.style.userSelect="none";const m=C=>{const w=he(),j=C.clientX-c,U=te(x-j,ee,w);Ce(U)},b=()=>{document.body.style.userSelect=u,window.removeEventListener("pointermove",m),window.removeEventListener("pointerup",b)};window.addEventListener("pointermove",m),window.addEventListener("pointerup",b)},Be=s=>{if(!W||S||!R.current||s.key!=="ArrowLeft"&&s.key!=="ArrowRight")return;s.preventDefault();const c=he(),x=s.key==="ArrowLeft"?24:-24;Ce(u=>te(u+x,ee,c))},Ye=()=>{qt(s=>!s),typeof window<"u"&&requestAnimationFrame(()=>G())},ss=()=>{Wt(s=>!s)},ze=()=>{Xt(s=>!s)},je=s=>{s&&(Ee(c=>`${c?`${c}

`:""}${s}`),e("Saved to session notes","success"))},Z=(s,c=!1)=>{if(s.isSystem&&s.id==="welcome"&&!c)return"";const x=s.createdAt||(typeof s.id=="number"?new Date(s.id).toISOString():null),u=x?new Date(x):c?new Date:null;return u?u.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):""},qe=X?"space-y-2":"space-y-4",Ve=X?"p-3":"p-4",We=(q[K]||q.medium).meta,ns=(s,c)=>{const[x,u]=h.useState(c?"":s);return h.useEffect(()=>{if(!c){u(s);return}let m=0;const b=setInterval(()=>{if(m>=s.length){clearInterval(b),u(s);return}const w=s.length>1e3?50:s.length>500?25:10;u(s.slice(0,m+w)),m+=w},10);return()=>clearInterval(b)},[s,c]),x},Xe=({text:s,shouldAnimate:c})=>{const x=ns(s,c);if(!x)return t.jsx("span",{className:"animate-pulse",children:"..."});const u=x.split(/(```[\s\S]*?```)/g),m=q[K]||q.medium,b=ye[Q]||ye.relaxed;return t.jsx("div",{className:`whitespace-pre-wrap ${b.class} ${m.message}`,children:u.map((C,w)=>{if(C.startsWith("```")&&C.endsWith("```")){const j=C.match(/^```(\w+)?\n([\s\S]*)```$/),U=j?j[1]:"",fe=j?j[2]:C.slice(3,-3);return t.jsxs("div",{className:"my-3 rounded-lg bg-slate-800 text-slate-100 overflow-hidden shadow-sm border border-slate-700",children:[t.jsxs("div",{className:"flex items-center justify-between px-3 py-1.5 bg-slate-900/50 text-slate-400 border-b border-white/10 select-none",children:[t.jsx("span",{className:`uppercase font-semibold tracking-wider ${m.meta}`,children:U||"CODE"}),t.jsxs("button",{onClick:tt=>{tt.stopPropagation(),Se(fe.trim())},className:"hover:text-white flex items-center gap-1.5 transition-colors text-xs","aria-label":"Copy code",children:[t.jsx(pe,{className:"h-3 w-3"})," Copy"]})]}),t.jsx("pre",{className:`p-3 overflow-x-auto font-mono ${m.code} scrollbar-thin scrollbar-thumb-slate-600 scrollbar-track-transparent`,children:t.jsx("code",{children:fe.trim()})})]},w)}return t.jsx("span",{children:C},w)})})},me=async()=>{if(!l.trim())return;const s={id:Date.now(),text:l,sender:"user",createdAt:new Date().toISOString()};r(u=>[...u,s]),d(""),re(!0),Me({id:s.id,text:s.text});const c=Zt(s.text);if(c){setTimeout(()=>{const u={id:Date.now()+1,text:c.answer,sender:"bot",link:c.link,createdAt:new Date().toISOString()};r(m=>[...m,u]),J(u.id),re(!1)},600);return}const x=f.trim();if(x){try{const u=new ln(x);let m,b;for(const _ of Ft)try{m=u.getGenerativeModel({model:_,systemInstruction:"You are an expert Power BI Developer and Data Analyst for the US Department of Health and Human Services (HHS). Answer questions concisely and professionally. If it involves DAX, provide code snippets."});break}catch(Ie){b=Ie;continue}if(!m)throw b||new Error("No compatible Gemini model found");const w=[...i.filter(_=>!_.isError&&!_.isSystem).map(_=>({role:_.sender==="user"?"user":"model",parts:[{text:_.text}]})),{role:"user",parts:[{text:s.text}]}],j=3e4,U=new Promise((_,Ie)=>setTimeout(()=>Ie(new Error("Request timeout")),j)),fe=m.generateContent({contents:w,generationConfig:{maxOutputTokens:1e3}}),as=(await(await Promise.race([fe,U])).response).text(),st={id:Date.now()+1,text:as,sender:"bot",createdAt:new Date().toISOString()};r(_=>[..._,st]),J(st.id)}catch(u){console.error("AI Connection Error:",u.message);const m=u.message?.includes("API_KEY")||u.message?.includes("PERMISSION_DENIED")||u.message?.includes("INVALID_ARGUMENT"),b=u.message?.includes("timeout")||u.message?.includes("Timeout"),C=u.message?.includes("network")||u.message?.includes("fetch");m&&(D("error"),L("Invalid API key or insufficient permissions"));let w;m?w="I couldn't connect to the AI service with the current access code. Please update your API key in settings, or I can help with local knowledge about DAX and Power BI.":b?w="The AI service is taking too long to respond. This can happen on slower connections. Please try again, or I can help with local knowledge about DAX and Power BI.":C?w="I'm having trouble reaching the AI service. Please check your internet connection and try again, or I can help with local knowledge about DAX and Power BI.":w="I'm having trouble connecting to the AI service right now. Let me help with what I know about DAX and Power BI instead.";const j={id:Date.now()+1,text:w,sender:"bot",isError:!0,createdAt:new Date().toISOString()};r(U=>[...U,j]),J(j.id)}finally{re(!1)}return}setTimeout(()=>{const u={id:Date.now()+1,text:"I don't have an answer for that in my local knowledge base. To unlock full AI capabilities, please configure the AI Access Code in settings.",sender:"bot",isSystem:!0,createdAt:new Date().toISOString()};r(m=>[...m,u]),J(u.id),re(!1)},600)},Je=!!ve,B=f?le==="connected"?{text:Re?`AI Connected (${Re})`:"AI Connected",className:"bg-emerald-100 text-emerald-700"}:le==="connecting"?{text:"Verifying Access Code",className:"bg-sky-100 text-sky-700"}:le==="error"?{text:"Connection Error",className:"bg-rose-100 text-rose-700"}:null:null,Qe=!S,Ze=W?{width:`${Oe}px`}:void 0,et=t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center justify-between mb-3 gap-2",children:[t.jsxs("div",{children:[t.jsxs("p",{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:[t.jsx(Es,{className:"h-4 w-4 text-brand-500"}),"Session Notes"]}),t.jsx("p",{className:"text-xs text-slate-500",children:"Capture insights or follow-ups"})]}),t.jsxs("div",{className:"flex gap-1",children:[t.jsx("button",{onClick:es,className:"p-2 text-slate-400 hover:text-brand-600 hover:bg-brand-50 rounded transition-colors",title:"Copy notes","aria-label":"Copy notes",children:t.jsx(pe,{className:"h-4 w-4"})}),t.jsx("button",{onClick:ts,className:"p-2 text-slate-400 hover:text-rose-600 hover:bg-rose-50 rounded transition-colors",title:"Clear notes","aria-label":"Clear notes",children:t.jsx(xs,{className:"h-4 w-4"})})]})]}),t.jsx("textarea",{value:$,onChange:s=>Ee(s.target.value),placeholder:"Capture project context, action items, or next steps...",className:"input-field flex-1 min-h-[200px] resize-none"}),t.jsxs("p",{className:"text-[11px] text-slate-400 text-right mt-2",children:["Autosaved locally • ",$.trim().length," chars"]})]});return Te?t.jsxs("div",{className:"fixed inset-0 z-50 bg-white flex flex-col",children:[t.jsxs("div",{className:"bg-slate-50 border-b border-slate-200 px-4 py-3 flex flex-wrap items-center justify-between gap-3",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(xe,{className:"h-5 w-5 text-brand-600"}),t.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Power BI Guru"}),B&&t.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full font-medium ${B.className}`,children:B.text})]}),t.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[t.jsxs("button",{onClick:a,"aria-pressed":n,"aria-label":n?"Show sidebar":"Hide sidebar",className:`hidden lg:flex p-2 rounded-lg text-sm font-medium items-center gap-2 border transition-colors ${n?"border-slate-200 text-slate-600 hover:bg-slate-100":"bg-emerald-50 text-emerald-700 border-emerald-100"}`,title:n?"Show sidebar":"Hide sidebar",children:[n?t.jsx(ut,{className:"h-4 w-4"}):t.jsx(dt,{className:"h-4 w-4"}),t.jsx("span",{className:"hidden xl:inline",children:n?"Show sidebar":"Hide sidebar"})]}),t.jsxs("button",{onClick:Ye,"aria-pressed":!S,"aria-label":S?"Show notes panel":"Hide notes panel",className:`p-2 rounded-lg text-sm font-medium flex items-center gap-2 border transition-colors ${S?"border-slate-200 text-slate-600 hover:bg-slate-100":"bg-brand-50 text-brand-700 border-brand-100"}`,children:[S?t.jsx(mt,{className:"h-4 w-4"}):t.jsx(ht,{className:"h-4 w-4"}),t.jsx("span",{className:"hidden sm:inline",children:S?"Show notes":"Hide notes"})]}),t.jsx("button",{onClick:ze,className:"p-2 hover:bg-slate-200 rounded-lg transition-colors text-slate-600",title:"Exit Fullscreen",children:t.jsx(Ns,{className:"h-5 w-5"})})]})]}),t.jsx("div",{className:"flex-1 flex flex-col overflow-hidden",children:t.jsxs("div",{ref:R,className:"flex-1 flex flex-col gap-4 lg:flex-row lg:items-stretch px-4 pb-4 pt-2 overflow-hidden",children:[t.jsxs("div",{className:"flex-1 flex flex-col min-w-0 bg-white relative border border-slate-200 rounded-xl shadow-sm",children:[t.jsxs("div",{className:"px-4 py-2 border-b border-slate-100 bg-white flex items-center gap-2 overflow-x-auto shrink-0",children:[t.jsxs("div",{className:"flex items-center gap-2 text-xs font-semibold uppercase text-slate-500 whitespace-nowrap",children:[t.jsx(ft,{className:"h-3 w-3 text-brand-500"}),"Quick prompts"]}),t.jsx("div",{className:"flex gap-2",children:Tt.map(s=>t.jsx("button",{onClick:()=>Ke(s.value),className:"flex-shrink-0 px-3 py-1 text-xs bg-slate-100 text-slate-700 rounded-full hover:bg-brand-50 hover:text-brand-700 transition-colors whitespace-nowrap",children:s.label},s.label))}),t.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[t.jsx("button",{onClick:()=>$e(!F),className:`p-1.5 rounded transition-colors flex items-center gap-1 ${F?"bg-brand-100 text-brand-700":"text-slate-400 hover:text-slate-600 hover:bg-slate-200"}`,title:"Text & Style Settings","aria-label":"Text style settings",children:t.jsx(ge,{className:"h-4 w-4"})}),t.jsx("button",{onClick:Pe,className:"p-1.5 text-slate-400 hover:text-slate-600 hover:bg-slate-200 rounded transition-colors",title:"Export chat","aria-label":"Export chat",children:t.jsx(ot,{className:"h-4 w-4"})}),t.jsx("button",{onClick:Ue,className:"p-1.5 text-slate-400 hover:text-red-500 hover:bg-red-50 rounded transition-colors",title:"Clear chat","aria-label":"Clear chat",children:t.jsx(nt,{className:"h-4 w-4"})})]})]}),t.jsx(Y,{children:F&&t.jsx(O.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden border-b border-slate-200",children:t.jsxs("div",{className:"px-4 py-3 bg-gradient-to-br from-brand-50 to-slate-50",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[t.jsx(ge,{className:"h-4 w-4 text-brand-600"}),t.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"Text & Style Settings"})]}),t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 max-w-3xl",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-slate-700 mb-2",children:"Font Size"}),t.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.entries(q).map(([s,c])=>t.jsxs("button",{onClick:()=>De(s),className:`px-3 py-2 text-xs rounded-lg border transition-all ${K===s?"bg-brand-600 text-white border-brand-600 shadow-md":"bg-white text-slate-700 border-slate-200 hover:border-brand-300 hover:bg-brand-50"}`,children:[t.jsx("div",{className:"font-semibold",children:c.label}),t.jsx("div",{className:"text-[10px] opacity-75",children:c.description})]},s))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-slate-700 mb-2",children:"Line Spacing"}),t.jsx("div",{className:"grid grid-cols-1 gap-2",children:Object.entries(ye).map(([s,c])=>t.jsx("button",{onClick:()=>Le(s),className:`px-3 py-2 text-xs rounded-lg border transition-all ${Q===s?"bg-brand-600 text-white border-brand-600 shadow-md":"bg-white text-slate-700 border-slate-200 hover:border-brand-300 hover:bg-brand-50"}`,children:c.label},s))})]})]}),t.jsxs("p",{className:"text-xs text-slate-500 mt-3 flex items-center gap-1",children:[t.jsx(xe,{className:"h-3 w-3"}),"Settings are saved automatically and persist across sessions"]})]})})}),t.jsxs("div",{ref:Ne,className:`flex-1 overflow-y-auto p-4 md:p-8 ${qe} relative`,children:[i.map(s=>t.jsx(O.div,{id:`message-${s.id}`,initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:`flex ${s.sender==="user"?"justify-end":"justify-start"}`,children:t.jsxs("div",{className:`max-w-[90%] md:max-w-[70%] rounded-2xl ${Ve} group relative shadow-sm ${s.sender==="user"?"bg-brand-600 text-white rounded-br-none":s.isSystem?"bg-amber-50 text-amber-800 border border-amber-100":"bg-slate-100 text-slate-800 rounded-bl-none"} ${s.id===ue?"ring-2 ring-brand-200 shadow-brand-200/60":""}`,children:[t.jsx("button",{onClick:()=>Se(s.text),className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity text-slate-400 hover:text-brand-600 bg-white/20 p-1 rounded",title:"Copy message","aria-label":"Copy message",children:t.jsx(pe,{className:"h-3 w-3"})}),s.sender==="bot"&&!s.isSystem&&t.jsx("button",{onClick:()=>je(s.text),className:"absolute top-2 right-12 opacity-0 group-hover:opacity-100 transition-opacity text-slate-400 hover:text-brand-600 bg-white/20 p-1 rounded",title:"Save to notes","aria-label":"Save to notes",children:t.jsx(_e,{className:"h-3 w-3"})}),t.jsxs("div",{className:`flex items-center justify-between mb-1 opacity-75 ${We}`,children:[t.jsxs("div",{className:"flex items-center gap-2",children:[s.sender==="user"?t.jsx(at,{className:"h-3 w-3"}):t.jsx(lt,{className:"h-3 w-3"}),t.jsx("span",{className:"uppercase font-bold tracking-wider",children:s.sender})]}),Z(s)&&t.jsx("span",{className:"opacity-75",children:Z(s)})]}),t.jsx(Xe,{text:s.text,shouldAnimate:s.id===ue&&s.sender==="bot"&&!s.isSystem}),s.link&&t.jsx("div",{className:"mt-3 pt-3 border-t border-black/10",children:t.jsxs("a",{href:`#${s.link}`,className:"text-xs font-bold flex items-center gap-1 hover:underline",children:["View Resource ",t.jsx(it,{className:"h-3 w-3"})]})})]})},s.id)),t.jsx(Y,{children:ie&&t.jsx(O.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"flex justify-start",children:t.jsxs("div",{className:"bg-slate-100 rounded-2xl rounded-bl-none p-4 flex gap-1",children:[t.jsx("span",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce"}),t.jsx("span",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce delay-75"}),t.jsx("span",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce delay-150"})]})})}),t.jsx("div",{ref:de})]}),t.jsxs("div",{className:"p-4 bg-slate-50 border-t border-slate-200 shrink-0",children:[t.jsxs("div",{className:"max-w-4xl mx-auto w-full flex gap-2",children:[t.jsx("textarea",{ref:V,value:l,onChange:s=>d(s.target.value),onKeyDown:s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),me())},placeholder:"Ask anything about Power BI... (Shift+Enter for new line)",className:"input-field flex-1 shadow-sm resize-none min-h-[48px] max-h-[200px]",rows:1}),t.jsx("button",{onClick:me,disabled:!l.trim()||ie,className:"btn-primary disabled:opacity-50 disabled:cursor-not-allowed px-6","aria-label":"Send message",children:t.jsx(rt,{className:"h-5 w-5"})})]}),!f&&t.jsxs("p",{className:"text-xs text-slate-400 mt-2 text-center",children:["Running in ",t.jsx("span",{className:"font-semibold text-brand-600",children:"Local Knowledge Mode"}),". Add an Access Code for full AI features."]})]})]}),Qe&&t.jsxs("div",{className:"flex flex-col gap-4 lg:gap-0 lg:flex-row shrink-0 w-full lg:w-auto",children:[W&&t.jsx("div",{className:"hidden lg:flex items-center justify-center w-5 cursor-col-resize select-none text-slate-400 hover:bg-slate-100 hover:text-brand-500 transition-colors -ml-2.5 z-10",role:"separator","aria-label":"Resize session notes panel","aria-orientation":"vertical",tabIndex:0,onPointerDown:Fe,onKeyDown:Be,title:"Drag to resize notes",children:t.jsx("div",{className:"flex flex-col items-center gap-1 bg-white/80 rounded-full px-1 py-3 shadow-sm border border-slate-200",children:t.jsx(ct,{className:"h-4 w-4"})})}),t.jsx("div",{className:"border border-slate-200 bg-slate-50 rounded-xl shadow-inner p-4 sm:p-5 flex flex-col w-full lg:w-auto transition-[width] duration-200 max-h-[300px] lg:max-h-none",style:Ze,children:et})]})]})})]}):t.jsxs("div",{className:"flex flex-col gap-4 min-h-[calc(100vh-10rem)] sm:min-h-[calc(100vh-8rem)]",children:[t.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-3 mb-2 sm:mb-4",children:[t.jsxs("div",{children:[t.jsxs("h2",{className:"text-xl sm:text-2xl font-bold text-slate-900 flex flex-wrap items-center gap-2",children:[t.jsx(xe,{className:"h-5 w-5 sm:h-6 sm:w-6 text-brand-600"}),"Power BI Guru",B&&t.jsx("span",{className:`text-[10px] sm:text-xs px-2 py-0.5 rounded-full font-medium ${B.className}`,children:B.text})]}),t.jsx("p",{className:"text-sm sm:text-base text-slate-600 mt-1",children:"Your AI assistant for DAX, Design, and Strategy."}),f&&t.jsx("p",{className:"mt-1 text-xs text-slate-500",children:p?"Using your personal Gemini access code.":Je?"Using the built-in HHS Gemini access code.":"Using the currently stored Gemini access code."}),le==="error"&&f&&t.jsxs("p",{className:"mt-1 text-sm text-rose-600 flex items-center gap-1",children:[t.jsx(rs,{className:"h-4 w-4"}),t.jsx("span",{children:Bt||"Unable to connect to the AI. Update the access code in settings."})]})]}),t.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[t.jsxs("button",{onClick:a,"aria-pressed":n,"aria-label":n?"Show sidebar":"Hide sidebar",className:`hidden lg:flex p-2.5 sm:p-2 rounded-lg text-sm font-medium items-center gap-2 border transition-colors ${n?"border-slate-200 text-slate-600 hover:bg-slate-100":"bg-emerald-50 text-emerald-700 border-emerald-100"}`,title:n?"Show sidebar":"Hide sidebar",children:[n?t.jsx(ut,{className:"h-4 w-4"}):t.jsx(dt,{className:"h-4 w-4"}),t.jsx("span",{className:"hidden xl:inline",children:n?"Show sidebar":"Hide sidebar"})]}),t.jsxs("button",{onClick:Ye,"aria-pressed":!S,"aria-label":S?"Show notes panel":"Hide notes panel",className:`p-2.5 sm:p-2 rounded-lg text-xs sm:text-sm font-medium flex items-center gap-1.5 sm:gap-2 border transition-colors ${S?"border-slate-200 text-slate-600 hover:bg-slate-100":"bg-brand-50 text-brand-700 border-brand-100"}`,children:[S?t.jsx(mt,{className:"h-4 w-4"}):t.jsx(ht,{className:"h-4 w-4"}),t.jsx("span",{className:"hidden sm:inline",children:S?"Show notes":"Hide notes"})]}),t.jsx("button",{onClick:ze,className:"p-2.5 sm:p-2 rounded-lg bg-slate-100 text-slate-600 hover:bg-slate-200 transition-colors",title:"Maximize (Fullscreen Mode)","aria-label":"Maximize (Fullscreen Mode)",children:t.jsx(bs,{className:"h-5 w-5"})}),t.jsx("button",{onClick:()=>k(!y),className:`p-2.5 sm:p-2 rounded-lg transition-colors ${y?"bg-brand-50 text-brand-700":p?"bg-emerald-100 text-emerald-700":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,title:"Manage AI Access Code","aria-label":"Manage AI Access Code",children:t.jsx(ks,{className:"h-5 w-5"})})]})]}),t.jsx(Y,{children:y&&t.jsx(O.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden mb-4",children:t.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-lg p-4",children:[t.jsxs("h3",{className:"font-semibold text-slate-900 mb-2 flex items-center gap-2",children:[t.jsx(ls,{className:"h-4 w-4"})," AI Settings"]}),t.jsx("p",{className:"text-sm text-slate-600 mb-3",children:"Enter your access code to enable full AI chat capabilities."}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("input",{type:"password",value:A,onChange:s=>I(s.target.value),placeholder:"Enter Access Code...",className:"input-field flex-1"}),t.jsx("button",{onClick:Jt,className:"btn-primary",children:"Save & Connect"}),p&&t.jsx("button",{onClick:Qt,className:"btn-secondary text-red-600 hover:bg-red-50",children:"Clear"})]}),t.jsxs("div",{className:"text-xs text-slate-500 mt-3 space-y-1",children:[t.jsx("p",{children:p?"Currently using your personal Gemini key. Clear to switch back to the built-in HHS access code.":Je?"Using the built-in HHS Gemini key by default. Add your own key if you need to run chats under a personal quota.":"No access code is configured yet. Add one to enable cloud AI responses."}),t.jsx("p",{className:"text-slate-400",children:"Any personal key you add stays in your browser only."})]})]})})}),t.jsxs("div",{ref:R,className:"flex-1 flex flex-col gap-4 lg:flex-row lg:items-stretch overflow-hidden",children:[t.jsxs("div",{className:"flex-1 bg-white border border-slate-200 rounded-xl shadow-sm overflow-hidden flex flex-col relative min-w-0 min-h-[420px]",children:[t.jsxs("div",{className:"bg-slate-50 border-b border-slate-200 px-3 sm:px-4 py-2 sm:py-3 flex flex-wrap items-center gap-3",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(ws,{className:"h-4 w-4 text-slate-500"}),t.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Conversation"}),t.jsxs("span",{className:"text-xs text-slate-500 bg-slate-200 px-2 py-0.5 rounded-full",children:[i.filter(s=>!s.isSystem).length," messages"]})]}),t.jsxs("div",{className:"flex gap-1.5 sm:gap-2 ml-auto",children:[t.jsx("button",{onClick:Pe,className:"p-1.5 text-slate-400 hover:text-slate-600 hover:bg-slate-200 rounded transition-colors",title:"Export chat",children:t.jsx(ot,{className:"h-4 w-4"})}),t.jsx("button",{onClick:Ue,className:"p-1.5 text-slate-400 hover:text-red-500 hover:bg-red-50 rounded transition-colors",title:"Clear chat",children:t.jsx(nt,{className:"h-4 w-4"})})]})]}),t.jsxs("div",{className:"px-3 sm:px-4 py-2 sm:py-3 border-b border-slate-100 bg-white flex flex-wrap items-center gap-2",children:[t.jsxs("div",{className:"flex items-center gap-2 text-[10px] sm:text-xs font-semibold uppercase text-slate-500",children:[t.jsx(ft,{className:"h-3 w-3 text-brand-500"}),t.jsx("span",{className:"hidden xs:inline",children:"Quick prompts"})]}),t.jsx("div",{className:"flex flex-wrap gap-1.5 sm:gap-2",children:Tt.map(s=>t.jsx("button",{onClick:()=>Ke(s.value),className:"px-2.5 sm:px-3 py-1.5 sm:py-1 text-[11px] sm:text-xs bg-slate-100 text-slate-700 rounded-full hover:bg-brand-50 hover:text-brand-700 transition-colors whitespace-nowrap flex-shrink-0",children:s.label},s.label))}),t.jsxs("div",{className:"ml-auto flex items-center gap-1.5 sm:gap-2",children:[t.jsxs("button",{onClick:()=>$e(!F),className:`text-[11px] sm:text-xs px-2.5 sm:px-3 py-1.5 sm:py-1 rounded-full border flex items-center gap-1 sm:gap-1.5 ${F?"bg-brand-600 text-white border-brand-600":"border-slate-200 text-slate-600 hover:bg-slate-100"}`,title:"Text & Style Settings","aria-label":"Text & Style Settings",children:[t.jsx(ge,{className:"h-3 w-3"}),t.jsx("span",{className:"hidden sm:inline",children:"Style"})]}),t.jsx("button",{onClick:ss,className:`text-[11px] sm:text-xs px-2.5 sm:px-3 py-1.5 sm:py-1 rounded-full border whitespace-nowrap ${X?"bg-brand-600 text-white border-brand-600":"border-slate-200 text-slate-600"}`,"aria-label":X?"Switch to normal mode":"Switch to compact mode",children:X?"Compact":"Normal"})]})]}),t.jsx(Y,{children:F&&t.jsx(O.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden border-b border-slate-200",children:t.jsxs("div",{className:"px-3 sm:px-4 py-3 bg-gradient-to-br from-brand-50 to-slate-50",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[t.jsx(ge,{className:"h-4 w-4 text-brand-600"}),t.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"Text & Style Settings"})]}),t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-slate-700 mb-2",children:"Font Size"}),t.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.entries(q).map(([s,c])=>t.jsxs("button",{onClick:()=>De(s),className:`px-3 py-2 text-xs rounded-lg border transition-all ${K===s?"bg-brand-600 text-white border-brand-600 shadow-md":"bg-white text-slate-700 border-slate-200 hover:border-brand-300 hover:bg-brand-50"}`,children:[t.jsx("div",{className:"font-semibold",children:c.label}),t.jsx("div",{className:"text-[10px] opacity-75",children:c.description})]},s))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-slate-700 mb-2",children:"Line Spacing"}),t.jsx("div",{className:"grid grid-cols-1 gap-2",children:Object.entries(ye).map(([s,c])=>t.jsx("button",{onClick:()=>Le(s),className:`px-3 py-2 text-xs rounded-lg border transition-all ${Q===s?"bg-brand-600 text-white border-brand-600 shadow-md":"bg-white text-slate-700 border-slate-200 hover:border-brand-300 hover:bg-brand-50"}`,children:c.label},s))})]})]}),t.jsxs("p",{className:"text-xs text-slate-500 mt-3 flex items-center gap-1",children:[t.jsx(xe,{className:"h-3 w-3"}),"Settings are saved automatically and persist across sessions"]})]})})}),H&&t.jsxs("div",{className:"px-3 sm:px-4 py-2 sm:py-3 border-b border-slate-100 bg-slate-50 flex flex-wrap items-center gap-3",children:[t.jsxs("div",{className:"flex-1 min-w-[240px]",children:[t.jsx("p",{className:"text-xs uppercase font-semibold text-slate-500 tracking-wide",children:"Current question"}),t.jsx("p",{className:"font-medium text-slate-900",children:pn(H.text,160)})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("button",{onClick:()=>He(H.id),className:"px-3 py-1.5 text-xs rounded-full bg-white border border-slate-200 hover:border-brand-300 hover:text-brand-600 transition-colors flex items-center gap-1",children:[t.jsx(us,{className:"h-3 w-3"})," Jump to question"]}),t.jsxs("button",{onClick:()=>je(H.text),className:"px-3 py-1.5 text-xs rounded-full bg-brand-50 text-brand-700 border border-brand-100 flex items-center gap-1",children:[t.jsx(_e,{className:"h-3 w-3"})," Save"]})]})]}),t.jsxs("div",{ref:Ne,className:`flex-1 overflow-y-auto p-3 sm:p-4 lg:p-5 ${qe} relative`,children:[i.map(s=>t.jsx(O.div,{id:`message-${s.id}`,initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:`flex ${s.sender==="user"?"justify-end":"justify-start"}`,children:t.jsxs("div",{className:`max-w-[80%] rounded-2xl ${Ve} group relative ${s.sender==="user"?"bg-brand-600 text-white rounded-br-none":s.isSystem?"bg-amber-50 text-amber-800 border border-amber-100":"bg-slate-100 text-slate-800 rounded-bl-none"} ${s.id===ue?"ring-2 ring-brand-200 shadow-lg shadow-brand-200/60":""}`,children:[t.jsx("button",{onClick:()=>Se(s.text),className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity text-slate-400 hover:text-brand-600",title:"Copy message","aria-label":"Copy message",children:t.jsx(pe,{className:"h-4 w-4"})}),s.sender==="bot"&&!s.isSystem&&t.jsx("button",{onClick:()=>je(s.text),className:"absolute top-2 right-10 opacity-0 group-hover:opacity-100 transition-opacity text-slate-400 hover:text-brand-600",title:"Save to notes","aria-label":"Save to notes",children:t.jsx(_e,{className:"h-4 w-4"})}),t.jsxs("div",{className:`flex items-center justify-between mb-1 opacity-75 ${We}`,children:[t.jsxs("div",{className:"flex items-center gap-2",children:[s.sender==="user"?t.jsx(at,{className:"h-3 w-3"}):t.jsx(lt,{className:"h-3 w-3"}),t.jsx("span",{className:"uppercase font-bold tracking-wider",children:s.sender})]}),Z(s)&&t.jsx("span",{className:"text-slate-400",children:Z(s)})]}),t.jsx(Xe,{text:s.text,shouldAnimate:s.id===ue&&s.sender==="bot"&&!s.isSystem}),s.link&&t.jsx("div",{className:"mt-3 pt-3 border-t border-black/10",children:t.jsxs("a",{href:`#${s.link}`,className:"text-xs font-bold flex items-center gap-1 hover:underline",children:["View Resource ",t.jsx(it,{className:"h-3 w-3"})]})})]})},s.id)),t.jsx(Y,{children:ie&&t.jsx(O.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"flex justify-start",children:t.jsxs("div",{className:"bg-slate-100 rounded-2xl rounded-bl-none p-4 flex gap-1",children:[t.jsx("span",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce"}),t.jsx("span",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce delay-75"}),t.jsx("span",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce delay-150"})]})})}),t.jsx("div",{ref:de})]}),t.jsx(Y,{children:!Yt&&t.jsx(O.button,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},onClick:Ge,className:"absolute bottom-24 right-4 bg-brand-600 text-white p-2 rounded-full shadow-lg hover:bg-brand-700 transition-colors z-10",title:"Scroll to bottom",children:t.jsx(cs,{className:"h-4 w-4"})})}),t.jsxs("div",{className:"p-3 sm:p-4 bg-slate-50 border-t border-slate-200",children:[t.jsxs("div",{className:"flex gap-2",children:[t.jsx("textarea",{ref:V,value:l,onChange:s=>d(s.target.value),onKeyDown:s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),me())},placeholder:"Ask anything about Power BI...",className:"input-field flex-1 shadow-sm resize-none min-h-[48px] sm:min-h-[44px] max-h-[200px] text-base sm:text-sm",rows:1}),t.jsx("button",{onClick:me,disabled:!l.trim()||ie,className:"btn-primary disabled:opacity-50 disabled:cursor-not-allowed min-w-[48px] sm:min-w-[44px]","aria-label":"Send message",children:t.jsx(rt,{className:"h-5 w-5 sm:h-4 sm:w-4"})})]}),t.jsxs("p",{className:"text-[10px] sm:text-xs text-slate-400 mt-2 text-center flex flex-wrap items-center justify-center gap-x-2 gap-y-1",children:[t.jsx("span",{className:"hidden sm:inline",children:"Enter = Send"}),t.jsx("span",{className:"hidden sm:inline",children:"Shift+Enter = New line"}),t.jsx("span",{className:"sm:hidden",children:"Tap Send or press Enter"}),t.jsx("span",{className:"hidden md:inline",children:"Copy buttons appear when you hover a message"})]}),!f&&t.jsxs("p",{className:"text-xs text-slate-400 mt-2 text-center",children:["Running in ",t.jsx("span",{className:"font-semibold text-brand-600",children:"Local Knowledge Mode"}),". Add an Access Code for full AI features."]})]})]}),Qe&&t.jsxs("div",{className:"flex flex-col gap-4 lg:gap-0 lg:flex-row shrink-0 w-full lg:w-auto",children:[W&&t.jsx("div",{className:"hidden lg:flex items-center justify-center w-5 cursor-col-resize select-none text-slate-400 hover:bg-slate-100 hover:text-brand-500 transition-colors -ml-2.5 z-10",role:"separator","aria-label":"Resize session notes panel","aria-orientation":"vertical",tabIndex:0,onPointerDown:Fe,onKeyDown:Be,title:"Drag to resize notes",children:t.jsx("div",{className:"flex flex-col items-center gap-1 bg-white/80 rounded-full px-1 py-3 shadow-sm border border-slate-200",children:t.jsx(ct,{className:"h-4 w-4"})})}),t.jsx("aside",{className:"bg-white border border-slate-200 rounded-xl shadow-sm p-4 sm:p-5 flex flex-col w-full lg:w-auto min-h-[260px] max-h-[300px] lg:max-h-none transition-[width] duration-200",style:Ze,children:et})]})]})]})};export{jn as default};
