import{c as N,u as ls,b as cs,r as h,j as t,d as F,T as at,A as B,m as O,e as ot,a as it}from"./index-DD5mDYnL.js";import{C as xe}from"./copy-BeVutCnj.js";import{T as pe}from"./type-DliZxUBA.js";import{D as rt}from"./download-B-FMAY5m.js";import{D as lt}from"./database-Cnqmm41P.js";import{S as ct,K as ds}from"./send-Bb1AY8c1.js";import{C as us}from"./chevron-down-CKGHNDfG.js";const hs=[["path",{d:"M12 17V3",key:"1cwfxf"}],["path",{d:"m6 11 6 6 6-6",key:"12ii2o"}],["path",{d:"M19 21H5",key:"150jfl"}]],ms=N("arrow-down-to-line",hs);const fs=[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}],["line",{x1:"12",x2:"12",y1:"7",y2:"13",key:"1cppfj"}],["line",{x1:"15",x2:"9",y1:"10",y2:"10",key:"1gty7f"}]],_e=N("bookmark-plus",fs);const xs=[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21",key:"g5wo59"}],["path",{d:"m5.082 11.09 8.828 8.828",key:"1wx5vj"}]],ps=N("eraser",xs);const gs=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],dt=N("grip-vertical",gs);const bs=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],ws=N("maximize-2",bs);const ys=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],vs=N("message-square",ys);const Ns=[["path",{d:"m14 10 7-7",key:"oa77jy"}],["path",{d:"M20 10h-6V4",key:"mjg0md"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M4 14h6v6",key:"rmj7iw"}]],Cs=N("minimize-2",Ns);const Es=[["path",{d:"M13.4 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-7.4",key:"re6nr2"}],["path",{d:"M2 6h4",key:"aawbzj"}],["path",{d:"M2 10h4",key:"l0bgd4"}],["path",{d:"M2 14h4",key:"1gsvsf"}],["path",{d:"M2 18h4",key:"1bu2t1"}],["path",{d:"M21.378 5.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"pqwjuv"}]],js=N("notebook-pen",Es);const Ss=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"m16 15-3-3 3-3",key:"14y99z"}]],ut=N("panel-left-close",Ss);const Is=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"m14 9 3 3-3 3",key:"8010ee"}]],ht=N("panel-left-open",Is);const _s=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M15 3v18",key:"14nvp0"}],["path",{d:"m8 9 3 3-3 3",key:"12hl5m"}]],mt=N("panel-right-close",_s);const As=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M15 3v18",key:"14nvp0"}],["path",{d:"m10 15-3-3 3-3",key:"1pgupc"}]],ft=N("panel-right-open",As);const ks=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Rs=N("settings",ks);const Os=[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]],xt=N("wand-sparkles",Os);var pt;(function(e){e.STRING="string",e.NUMBER="number",e.INTEGER="integer",e.BOOLEAN="boolean",e.ARRAY="array",e.OBJECT="object"})(pt||(pt={}));var gt;(function(e){e.LANGUAGE_UNSPECIFIED="language_unspecified",e.PYTHON="python"})(gt||(gt={}));var bt;(function(e){e.OUTCOME_UNSPECIFIED="outcome_unspecified",e.OUTCOME_OK="outcome_ok",e.OUTCOME_FAILED="outcome_failed",e.OUTCOME_DEADLINE_EXCEEDED="outcome_deadline_exceeded"})(bt||(bt={}));const wt=["user","model","function","system"];var yt;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(yt||(yt={}));var vt;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(vt||(vt={}));var Nt;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(Nt||(Nt={}));var Ct;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER"})(Ct||(Ct={}));var ne;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.OTHER="OTHER"})(ne||(ne={}));var Et;(function(e){e.TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",e.RETRIEVAL_QUERY="RETRIEVAL_QUERY",e.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",e.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",e.CLASSIFICATION="CLASSIFICATION",e.CLUSTERING="CLUSTERING"})(Et||(Et={}));var jt;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE"})(jt||(jt={}));var St;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(St||(St={}));class w extends Error{constructor(s){super(`[GoogleGenerativeAI Error]: ${s}`)}}class Y extends w{constructor(s,a){super(s),this.response=a}}class Pt extends w{constructor(s,a,o,i){super(s),this.status=a,this.statusText=o,this.errorDetails=i}}class M extends w{}class Kt extends w{}const Ts="https://generativelanguage.googleapis.com",Ms="v1beta",Ds="0.24.1",Ls="genai-js";var G;(function(e){e.GENERATE_CONTENT="generateContent",e.STREAM_GENERATE_CONTENT="streamGenerateContent",e.COUNT_TOKENS="countTokens",e.EMBED_CONTENT="embedContent",e.BATCH_EMBED_CONTENTS="batchEmbedContents"})(G||(G={}));class Hs{constructor(s,a,o,i,r){this.model=s,this.task=a,this.apiKey=o,this.stream=i,this.requestOptions=r}toString(){var s,a;const o=((s=this.requestOptions)===null||s===void 0?void 0:s.apiVersion)||Ms;let r=`${((a=this.requestOptions)===null||a===void 0?void 0:a.baseUrl)||Ts}/${o}/${this.model}:${this.task}`;return this.stream&&(r+="?alt=sse"),r}}function $s(e){const s=[];return e?.apiClient&&s.push(e.apiClient),s.push(`${Ls}/${Ds}`),s.join(" ")}async function Gs(e){var s;const a=new Headers;a.append("Content-Type","application/json"),a.append("x-goog-api-client",$s(e.requestOptions)),a.append("x-goog-api-key",e.apiKey);let o=(s=e.requestOptions)===null||s===void 0?void 0:s.customHeaders;if(o){if(!(o instanceof Headers))try{o=new Headers(o)}catch(i){throw new M(`unable to convert customHeaders value ${JSON.stringify(o)} to Headers: ${i.message}`)}for(const[i,r]of o.entries()){if(i==="x-goog-api-key")throw new M(`Cannot set reserved header name ${i}`);if(i==="x-goog-api-client")throw new M(`Header name ${i} can only be set using the apiClient field`);a.append(i,r)}}return a}async function Ps(e,s,a,o,i,r){const l=new Hs(e,s,a,o,r);return{url:l.toString(),fetchOptions:Object.assign(Object.assign({},Bs(r)),{method:"POST",headers:await Gs(l),body:i})}}async function ie(e,s,a,o,i,r={},l=fetch){const{url:d,fetchOptions:m}=await Ps(e,s,a,o,i,r);return Ks(d,m,l)}async function Ks(e,s,a=fetch){let o;try{o=await a(e,s)}catch(i){Us(i,e)}return o.ok||await Fs(o,e),o}function Us(e,s){let a=e;throw a.name==="AbortError"?(a=new Kt(`Request aborted when fetching ${s.toString()}: ${e.message}`),a.stack=e.stack):e instanceof Pt||e instanceof M||(a=new w(`Error fetching from ${s.toString()}: ${e.message}`),a.stack=e.stack),a}async function Fs(e,s){let a="",o;try{const i=await e.json();a=i.error.message,i.error.details&&(a+=` ${JSON.stringify(i.error.details)}`,o=i.error.details)}catch{}throw new Pt(`Error fetching from ${s.toString()}: [${e.status} ${e.statusText}] ${a}`,e.status,e.statusText,o)}function Bs(e){const s={};if(e?.signal!==void 0||e?.timeout>=0){const a=new AbortController;e?.timeout>=0&&setTimeout(()=>a.abort(),e.timeout),e?.signal&&e.signal.addEventListener("abort",()=>{a.abort()}),s.signal=a.signal}return s}function Re(e){return e.text=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`),we(e.candidates[0]))throw new Y(`${T(e)}`,e);return Ys(e)}else if(e.promptFeedback)throw new Y(`Text not available. ${T(e)}`,e);return""},e.functionCall=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),we(e.candidates[0]))throw new Y(`${T(e)}`,e);return console.warn("response.functionCall() is deprecated. Use response.functionCalls() instead."),It(e)[0]}else if(e.promptFeedback)throw new Y(`Function call not available. ${T(e)}`,e)},e.functionCalls=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),we(e.candidates[0]))throw new Y(`${T(e)}`,e);return It(e)}else if(e.promptFeedback)throw new Y(`Function call not available. ${T(e)}`,e)},e}function Ys(e){var s,a,o,i;const r=[];if(!((a=(s=e.candidates)===null||s===void 0?void 0:s[0].content)===null||a===void 0)&&a.parts)for(const l of(i=(o=e.candidates)===null||o===void 0?void 0:o[0].content)===null||i===void 0?void 0:i.parts)l.text&&r.push(l.text),l.executableCode&&r.push("\n```"+l.executableCode.language+`
`+l.executableCode.code+"\n```\n"),l.codeExecutionResult&&r.push("\n```\n"+l.codeExecutionResult.output+"\n```\n");return r.length>0?r.join(""):""}function It(e){var s,a,o,i;const r=[];if(!((a=(s=e.candidates)===null||s===void 0?void 0:s[0].content)===null||a===void 0)&&a.parts)for(const l of(i=(o=e.candidates)===null||o===void 0?void 0:o[0].content)===null||i===void 0?void 0:i.parts)l.functionCall&&r.push(l.functionCall);if(r.length>0)return r}const zs=[ne.RECITATION,ne.SAFETY,ne.LANGUAGE];function we(e){return!!e.finishReason&&zs.includes(e.finishReason)}function T(e){var s,a,o;let i="";if((!e.candidates||e.candidates.length===0)&&e.promptFeedback)i+="Response was blocked",!((s=e.promptFeedback)===null||s===void 0)&&s.blockReason&&(i+=` due to ${e.promptFeedback.blockReason}`),!((a=e.promptFeedback)===null||a===void 0)&&a.blockReasonMessage&&(i+=`: ${e.promptFeedback.blockReasonMessage}`);else if(!((o=e.candidates)===null||o===void 0)&&o[0]){const r=e.candidates[0];we(r)&&(i+=`Candidate was blocked due to ${r.finishReason}`,r.finishMessage&&(i+=`: ${r.finishMessage}`))}return i}function ae(e){return this instanceof ae?(this.v=e,this):new ae(e)}function qs(e,s,a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o=a.apply(e,s||[]),i,r=[];return i={},l("next"),l("throw"),l("return"),i[Symbol.asyncIterator]=function(){return this},i;function l(p){o[p]&&(i[p]=function(g){return new Promise(function(b,k){r.push([p,g,b,k])>1||d(p,g)})})}function d(p,g){try{m(o[p](g))}catch(b){I(r[0][3],b)}}function m(p){p.value instanceof ae?Promise.resolve(p.value.v).then(C,A):I(r[0][2],p)}function C(p){d("next",p)}function A(p){d("throw",p)}function I(p,g){p(g),r.shift(),r.length&&d(r[0][0],r[0][1])}}const _t=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;function Vs(e){const s=e.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0})),a=Js(s),[o,i]=a.tee();return{stream:Xs(o),response:Ws(i)}}async function Ws(e){const s=[],a=e.getReader();for(;;){const{done:o,value:i}=await a.read();if(o)return Re(Qs(s));s.push(i)}}function Xs(e){return qs(this,arguments,function*(){const a=e.getReader();for(;;){const{value:o,done:i}=yield ae(a.read());if(i)break;yield yield ae(Re(o))}})}function Js(e){const s=e.getReader();return new ReadableStream({start(o){let i="";return r();function r(){return s.read().then(({value:l,done:d})=>{if(d){if(i.trim()){o.error(new w("Failed to parse stream"));return}o.close();return}i+=l;let m=i.match(_t),C;for(;m;){try{C=JSON.parse(m[1])}catch{o.error(new w(`Error parsing JSON response: "${m[1]}"`));return}o.enqueue(C),i=i.substring(m[0].length),m=i.match(_t)}return r()}).catch(l=>{let d=l;throw d.stack=l.stack,d.name==="AbortError"?d=new Kt("Request aborted when reading from the stream"):d=new w("Error reading from the stream"),d})}}})}function Qs(e){const s=e[e.length-1],a={promptFeedback:s?.promptFeedback};for(const o of e){if(o.candidates){let i=0;for(const r of o.candidates)if(a.candidates||(a.candidates=[]),a.candidates[i]||(a.candidates[i]={index:i}),a.candidates[i].citationMetadata=r.citationMetadata,a.candidates[i].groundingMetadata=r.groundingMetadata,a.candidates[i].finishReason=r.finishReason,a.candidates[i].finishMessage=r.finishMessage,a.candidates[i].safetyRatings=r.safetyRatings,r.content&&r.content.parts){a.candidates[i].content||(a.candidates[i].content={role:r.content.role||"user",parts:[]});const l={};for(const d of r.content.parts)d.text&&(l.text=d.text),d.functionCall&&(l.functionCall=d.functionCall),d.executableCode&&(l.executableCode=d.executableCode),d.codeExecutionResult&&(l.codeExecutionResult=d.codeExecutionResult),Object.keys(l).length===0&&(l.text=""),a.candidates[i].content.parts.push(l)}i++}o.usageMetadata&&(a.usageMetadata=o.usageMetadata)}return a}async function Ut(e,s,a,o){const i=await ie(s,G.STREAM_GENERATE_CONTENT,e,!0,JSON.stringify(a),o);return Vs(i)}async function Ft(e,s,a,o){const r=await(await ie(s,G.GENERATE_CONTENT,e,!1,JSON.stringify(a),o)).json();return{response:Re(r)}}function Bt(e){if(e!=null){if(typeof e=="string")return{role:"system",parts:[{text:e}]};if(e.text)return{role:"system",parts:[e]};if(e.parts)return e.role?e:{role:"system",parts:e.parts}}}function oe(e){let s=[];if(typeof e=="string")s=[{text:e}];else for(const a of e)typeof a=="string"?s.push({text:a}):s.push(a);return Zs(s)}function Zs(e){const s={role:"user",parts:[]},a={role:"function",parts:[]};let o=!1,i=!1;for(const r of e)"functionResponse"in r?(a.parts.push(r),i=!0):(s.parts.push(r),o=!0);if(o&&i)throw new w("Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.");if(!o&&!i)throw new w("No content is provided for sending chat message.");return o?s:a}function en(e,s){var a;let o={model:s?.model,generationConfig:s?.generationConfig,safetySettings:s?.safetySettings,tools:s?.tools,toolConfig:s?.toolConfig,systemInstruction:s?.systemInstruction,cachedContent:(a=s?.cachedContent)===null||a===void 0?void 0:a.name,contents:[]};const i=e.generateContentRequest!=null;if(e.contents){if(i)throw new M("CountTokensRequest must have one of contents or generateContentRequest, not both.");o.contents=e.contents}else if(i)o=Object.assign(Object.assign({},o),e.generateContentRequest);else{const r=oe(e);o.contents=[r]}return{generateContentRequest:o}}function At(e){let s;return e.contents?s=e:s={contents:[oe(e)]},e.systemInstruction&&(s.systemInstruction=Bt(e.systemInstruction)),s}function tn(e){return typeof e=="string"||Array.isArray(e)?{content:oe(e)}:e}const kt=["text","inlineData","functionCall","functionResponse","executableCode","codeExecutionResult"],sn={user:["text","inlineData"],function:["functionResponse"],model:["text","functionCall","executableCode","codeExecutionResult"],system:["text"]};function nn(e){let s=!1;for(const a of e){const{role:o,parts:i}=a;if(!s&&o!=="user")throw new w(`First content should be with role 'user', got ${o}`);if(!wt.includes(o))throw new w(`Each item should include role field. Got ${o} but valid roles are: ${JSON.stringify(wt)}`);if(!Array.isArray(i))throw new w("Content should have 'parts' property with an array of Parts");if(i.length===0)throw new w("Each Content should have at least one part");const r={text:0,inlineData:0,functionCall:0,functionResponse:0,fileData:0,executableCode:0,codeExecutionResult:0};for(const d of i)for(const m of kt)m in d&&(r[m]+=1);const l=sn[o];for(const d of kt)if(!l.includes(d)&&r[d]>0)throw new w(`Content with role '${o}' can't contain '${d}' part`);s=!0}}function Rt(e){var s;if(e.candidates===void 0||e.candidates.length===0)return!1;const a=(s=e.candidates[0])===null||s===void 0?void 0:s.content;if(a===void 0||a.parts===void 0||a.parts.length===0)return!1;for(const o of a.parts)if(o===void 0||Object.keys(o).length===0||o.text!==void 0&&o.text==="")return!1;return!0}const Ot="SILENT_ERROR";class an{constructor(s,a,o,i={}){this.model=a,this.params=o,this._requestOptions=i,this._history=[],this._sendPromise=Promise.resolve(),this._apiKey=s,o?.history&&(nn(o.history),this._history=o.history)}async getHistory(){return await this._sendPromise,this._history}async sendMessage(s,a={}){var o,i,r,l,d,m;await this._sendPromise;const C=oe(s),A={safetySettings:(o=this.params)===null||o===void 0?void 0:o.safetySettings,generationConfig:(i=this.params)===null||i===void 0?void 0:i.generationConfig,tools:(r=this.params)===null||r===void 0?void 0:r.tools,toolConfig:(l=this.params)===null||l===void 0?void 0:l.toolConfig,systemInstruction:(d=this.params)===null||d===void 0?void 0:d.systemInstruction,cachedContent:(m=this.params)===null||m===void 0?void 0:m.cachedContent,contents:[...this._history,C]},I=Object.assign(Object.assign({},this._requestOptions),a);let p;return this._sendPromise=this._sendPromise.then(()=>Ft(this._apiKey,this.model,A,I)).then(g=>{var b;if(Rt(g.response)){this._history.push(C);const k=Object.assign({parts:[],role:"model"},(b=g.response.candidates)===null||b===void 0?void 0:b[0].content);this._history.push(k)}else{const k=T(g.response);k&&console.warn(`sendMessage() was unsuccessful. ${k}. Inspect response object for details.`)}p=g}).catch(g=>{throw this._sendPromise=Promise.resolve(),g}),await this._sendPromise,p}async sendMessageStream(s,a={}){var o,i,r,l,d,m;await this._sendPromise;const C=oe(s),A={safetySettings:(o=this.params)===null||o===void 0?void 0:o.safetySettings,generationConfig:(i=this.params)===null||i===void 0?void 0:i.generationConfig,tools:(r=this.params)===null||r===void 0?void 0:r.tools,toolConfig:(l=this.params)===null||l===void 0?void 0:l.toolConfig,systemInstruction:(d=this.params)===null||d===void 0?void 0:d.systemInstruction,cachedContent:(m=this.params)===null||m===void 0?void 0:m.cachedContent,contents:[...this._history,C]},I=Object.assign(Object.assign({},this._requestOptions),a),p=Ut(this._apiKey,this.model,A,I);return this._sendPromise=this._sendPromise.then(()=>p).catch(g=>{throw new Error(Ot)}).then(g=>g.response).then(g=>{if(Rt(g)){this._history.push(C);const b=Object.assign({},g.candidates[0].content);b.role||(b.role="model"),this._history.push(b)}else{const b=T(g);b&&console.warn(`sendMessageStream() was unsuccessful. ${b}. Inspect response object for details.`)}}).catch(g=>{g.message!==Ot&&console.error(g)}),p}}async function on(e,s,a,o){return(await ie(s,G.COUNT_TOKENS,e,!1,JSON.stringify(a),o)).json()}async function rn(e,s,a,o){return(await ie(s,G.EMBED_CONTENT,e,!1,JSON.stringify(a),o)).json()}async function ln(e,s,a,o){const i=a.requests.map(l=>Object.assign(Object.assign({},l),{model:s}));return(await ie(s,G.BATCH_EMBED_CONTENTS,e,!1,JSON.stringify({requests:i}),o)).json()}class Tt{constructor(s,a,o={}){this.apiKey=s,this._requestOptions=o,a.model.includes("/")?this.model=a.model:this.model=`models/${a.model}`,this.generationConfig=a.generationConfig||{},this.safetySettings=a.safetySettings||[],this.tools=a.tools,this.toolConfig=a.toolConfig,this.systemInstruction=Bt(a.systemInstruction),this.cachedContent=a.cachedContent}async generateContent(s,a={}){var o;const i=At(s),r=Object.assign(Object.assign({},this._requestOptions),a);return Ft(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(o=this.cachedContent)===null||o===void 0?void 0:o.name},i),r)}async generateContentStream(s,a={}){var o;const i=At(s),r=Object.assign(Object.assign({},this._requestOptions),a);return Ut(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(o=this.cachedContent)===null||o===void 0?void 0:o.name},i),r)}startChat(s){var a;return new an(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(a=this.cachedContent)===null||a===void 0?void 0:a.name},s),this._requestOptions)}async countTokens(s,a={}){const o=en(s,{model:this.model,generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:this.cachedContent}),i=Object.assign(Object.assign({},this._requestOptions),a);return on(this.apiKey,this.model,o,i)}async embedContent(s,a={}){const o=tn(s),i=Object.assign(Object.assign({},this._requestOptions),a);return rn(this.apiKey,this.model,o,i)}async batchEmbedContents(s,a={}){const o=Object.assign(Object.assign({},this._requestOptions),a);return ln(this.apiKey,this.model,s,o)}}class cn{constructor(s){this.apiKey=s}getGenerativeModel(s,a){if(!s.model)throw new w("Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })");return new Tt(this.apiKey,s,a)}getGenerativeModelFromCachedContent(s,a,o){if(!s.name)throw new M("Cached content must contain a `name` field.");if(!s.model)throw new M("Cached content must contain a `model` field.");const i=["model","systemInstruction"];for(const l of i)if(a?.[l]&&s[l]&&a?.[l]!==s[l]){if(l==="model"){const d=a.model.startsWith("models/")?a.model.replace("models/",""):a.model,m=s.model.startsWith("models/")?s.model.replace("models/",""):s.model;if(d===m)continue}throw new M(`Different value for "${l}" specified in modelParams (${a[l]}) and cachedContent (${s[l]})`)}const r=Object.assign(Object.assign({},a),{model:s.model,tools:s.tools,toolConfig:s.toolConfig,systemInstruction:s.systemInstruction,cachedContent:s});return new Tt(this.apiKey,r,o)}}const dn=[{keywords:["yoy","year over year","growth"],answer:"For Year-over-Year growth, use the 'YoY Growth %' pattern in the DAX Library. It uses `SAMEPERIODLASTYEAR`.",link:"/dax"},{keywords:["blue","color","hex","brand"],answer:"The official HHS Blue hex code is #005EA2. You can find the full palette in the Style Guide.",link:"/style-guide"},{keywords:["pareto","80/20"],answer:"We have a Pareto Analysis pattern in the DAX Library under 'Advanced Analytics'.",link:"/dax"},{keywords:["font","typography"],answer:"The approved font is 'Source Sans Pro'. See the Style Guide for heading sizes.",link:"/style-guide"},{keywords:["dax","measure","calculation"],answer:"The DAX Library contains patterns for Time Intelligence, Financial Formulas, and more. Check the 'DAX Library' tab.",link:"/dax"}],te=180,Ae=4e3,un=280,se=(e,s,a)=>Math.min(Math.max(e,s),a),hn=()=>typeof window>"u"?360:se(window.innerWidth*.3,te,Ae),ge=()=>({id:"welcome",text:"Hi, I'm your Analytics Assistant. Ask me about DAX, HHS Branding, or data strategy.",sender:"guru",isSystem:!0,createdAt:new Date().toISOString()}),Mt=[{label:"Generate DAX",value:"Create a reusable DAX measure for year-over-year revenue with clear comments."},{label:"Explain Visual",value:"Explain how to design an executive KPI card for Power BI with HHS branding guidance."},{label:"Build Checklist",value:"Give me a pre-publish checklist for a Power BI report destined for leadership review."},{label:"Debug Measure",value:"Help me troubleshoot why my DAX measure is returning blank values."}],Dt="guru_session_notes",Lt="guru_messages",Ht="guru_font_size",$t="guru_line_height",z={small:{label:"Small",message:"text-xs",meta:"text-[10px]",code:"text-xs",description:"Compact"},medium:{label:"Medium",message:"text-sm",meta:"text-xs",code:"text-sm",description:"Default"},large:{label:"Large",message:"text-base",meta:"text-sm",code:"text-base",description:"Comfortable"},xlarge:{label:"Extra Large",message:"text-lg",meta:"text-sm",code:"text-base",description:"Accessibility"}},be={normal:{label:"Normal",class:"leading-normal"},relaxed:{label:"Relaxed",class:"leading-relaxed"},loose:{label:"Loose",class:"leading-loose"}},Yt=["gemini-2.5-flash","gemini-2.0-flash","gemini-1.5-flash","gemini-pro"];Yt[0];const ye="AIzaSyBQmBPQc-dFJRa9456iCbZBHrMimbO1s9A".trim()||"",mn="localhost,127.0.0.1,williamdalston.github.io",fn=e=>e.split(",").map(s=>s.trim()).filter(Boolean).map(s=>s.replace(/^https?:\/\//,"").split("/")[0].toLowerCase()),xn=(e,s,a)=>{if(e==="*")return!0;if(e.startsWith(".")){const o=e.slice(1);return s===o||s.endsWith(`.${o}`)}return e.includes(":")?a===e:s===e},Gt=fn(mn),pn=()=>{if(!ye||typeof window>"u")return!1;if(Gt.length===0)return!0;const e=window.location.hostname.toLowerCase(),s=window.location.host.toLowerCase();return Gt.some(a=>xn(a,e,s))},ke=()=>pn()?ye:"",gn=()=>{if(typeof window>"u")return"";const e=window.localStorage.getItem("gemini_api_key");return e?e.trim():""},bn=()=>{const e=gn();if(e)return{key:e,source:"custom"};const s=ke();return s?{key:s,source:"project"}:{key:"",source:"none"}},wn=(e,s=120)=>e?e.length>s?`${e.slice(0,s)}…`:e:"",Rn=()=>{const{addToast:e}=ls(),{isSidebarCollapsed:s,toggleSidebar:a}=cs(),o=h.useRef(bn()),[i,r]=h.useState(()=>{if(typeof window>"u")return[ge()];try{const n=window.localStorage.getItem(Lt);return n?JSON.parse(n).map(f=>f.sender==="bot"?{...f,sender:"guru"}:f):[ge()]}catch(n){return console.error("Failed to parse messages",n),[ge()]}}),[l,d]=h.useState(""),[m,C]=h.useState(o.current.key),[A,I]=h.useState(o.current.source==="custom"?o.current.key:""),[p,g]=h.useState(o.current.source==="custom"),[b,k]=h.useState(!1),[re,le]=h.useState(!1),[ce,q]=h.useState(o.current.key?"connecting":"idle"),[zt,V]=h.useState(""),[Oe,Te]=h.useState(null),de=h.useRef(null),ve=h.useRef(null),[qt,Vt]=h.useState(!0),W=h.useRef(null),R=h.useRef(null),[Me,Ne]=h.useState(()=>hn()),[E,Wt]=h.useState(!1),[X,Xt]=h.useState(()=>typeof window>"u"?!1:window.innerWidth>=1024),[D,Ce]=h.useState(()=>typeof window>"u"?"":window.localStorage.getItem(Dt)||""),[J,Jt]=h.useState(!1),[De,Qt]=h.useState(!1),[L,Le]=h.useState(null),[ue,Q]=h.useState(null),[P,He]=h.useState(()=>typeof window>"u"?"medium":window.localStorage.getItem(Ht)||"medium"),[Z,$e]=h.useState(()=>typeof window>"u"?"relaxed":window.localStorage.getItem($t)||"relaxed"),[K,Ge]=h.useState(!1),he=h.useCallback(()=>{if(!R.current||typeof window>"u")return Ae;const n=window.getComputedStyle(R.current),c=parseFloat(n.columnGap||n.gap||"0")||0,u=R.current.getBoundingClientRect().width-c-un;return se(u,te,Ae)},[R]),H=h.useCallback(()=>{if(typeof window>"u")return;const n=window.innerWidth>=1024;if(Xt(n),!n)return;const c=he();Ne(f=>se(f,te,c))},[he]);h.useEffect(()=>{},[]),h.useEffect(()=>{if(H(),!(typeof window>"u"))return window.addEventListener("resize",H),()=>window.removeEventListener("resize",H)},[H]),h.useEffect(()=>{H()},[De,H]),h.useEffect(()=>{typeof window>"u"||window.localStorage.setItem(Lt,JSON.stringify(i))},[i]);const Pe=n=>{if(!n)return;const c=document.getElementById(`message-${n}`);c&&c.scrollIntoView({behavior:"smooth",block:"start"})};h.useEffect(()=>{const n=i[i.length-1];if(n?.sender==="guru"&&!n.isSystem&&L?.id){Pe(L.id);return}de.current?.scrollIntoView({behavior:"smooth"})},[i,L]),h.useEffect(()=>{const n=ve.current;if(!n)return;const c=()=>{const{scrollTop:f,scrollHeight:u,clientHeight:x}=n,v=f+x>=u-10;Vt(v)};return n.addEventListener("scroll",c),c(),()=>n.removeEventListener("scroll",c)},[i]);const Ke=()=>{de.current?.scrollIntoView({behavior:"smooth"})};h.useEffect(()=>{typeof window>"u"||window.localStorage.setItem(Dt,D)},[D]),h.useEffect(()=>{typeof window>"u"||window.localStorage.setItem(Ht,P)},[P]),h.useEffect(()=>{typeof window>"u"||window.localStorage.setItem($t,Z)},[Z]),h.useEffect(()=>{if(!W.current)return;const n=W.current;n.style.height="auto";const f=Math.min(n.scrollHeight,200);n.style.height=`${f}px`},[l]),h.useEffect(()=>{if(!m.trim()){q("idle"),V(""),Te(null);return}q("connected"),V(""),Te("v1beta")},[m]);const Zt=()=>{const n=A.trim();if(!n){e("Please enter a valid access code","error");return}typeof window<"u"&&window.localStorage.setItem("gemini_api_key",n),g(!0),C(n),I(""),q("connecting"),V(""),k(!1),e("Personal access code saved. Connecting now...","success")},es=()=>{typeof window<"u"&&window.localStorage.removeItem("gemini_api_key");const n=ke()||"",c=!!ye&&!n;g(!1),I(""),C(n),q(n?"connecting":"idle"),V(""),e(n?"Reverted to the built-in HHS access code.":c?"The built-in HHS access code is restricted on this domain. Add your personal key to enable AI responses.":"Access code removed. Running in local knowledge mode.","info")},ts=n=>{const c=n.toLowerCase();return dn.find(f=>f.keywords.some(u=>c.includes(u)))},Ee=async n=>{if(n)try{if(typeof navigator>"u"||!navigator.clipboard)throw new Error("Clipboard unavailable");await navigator.clipboard.writeText(n),e("Message copied to clipboard","success")}catch(c){console.error("Copy failed",c),e("Unable to copy message","error")}},Ue=()=>{confirm("Clear this conversation and start fresh?")&&(r([ge()]),e("Conversation cleared","success"),Ke(),Le(null),Q(null))},Fe=()=>{const n=i.filter(x=>!x.isSystem).map(x=>`${x.sender.toUpperCase()} (${ee(x,!0)}):
${x.text}`).join(`

---

`),c=new Blob([n],{type:"text/plain"}),f=URL.createObjectURL(c),u=document.createElement("a");u.href=f,u.download=`power-bi-guru-chat-${new Date().toISOString().split("T")[0]}.txt`,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(f),e("Chat exported","success")},Be=n=>{d(n),W.current?.focus()},ss=async()=>{if(!D.trim()){e("No notes to copy","info");return}try{await navigator.clipboard.writeText(D),e("Session notes copied","success")}catch(n){console.error("Copy notes failed",n),e("Unable to copy notes","error")}},ns=()=>{D.trim()&&confirm("Clear session notes?")&&(Ce(""),e("Session notes cleared","success"))},Ye=n=>{if(!X||E||!R.current)return;n.preventDefault();const c=n.clientX,f=Me,u=document.body.style.userSelect;document.body.style.userSelect="none";const x=j=>{const y=he(),S=j.clientX-c,$=se(f-S,te,y);Ne($)},v=()=>{document.body.style.userSelect=u,window.removeEventListener("pointermove",x),window.removeEventListener("pointerup",v)};window.addEventListener("pointermove",x),window.addEventListener("pointerup",v)},ze=n=>{if(!X||E||!R.current||n.key!=="ArrowLeft"&&n.key!=="ArrowRight")return;n.preventDefault();const c=he(),f=n.key==="ArrowLeft"?24:-24;Ne(u=>se(u+f,te,c))},qe=()=>{Wt(n=>!n),typeof window<"u"&&requestAnimationFrame(()=>H())},as=()=>{Jt(n=>!n)},Ve=()=>{Qt(n=>!n)},je=n=>{n&&(Ce(c=>`${c?`${c}

`:""}${n}`),e("Saved to session notes","success"))},ee=(n,c=!1)=>{if(n.isSystem&&n.id==="welcome"&&!c)return"";const f=n.createdAt||(typeof n.id=="number"?new Date(n.id).toISOString():null),u=f?new Date(f):c?new Date:null;return u?u.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):""},We=J?"space-y-2":"space-y-4",Xe=J?"p-3":"p-4",Je=(z[P]||z.medium).meta,os=(n,c)=>{const[f,u]=h.useState(c?"":n);return h.useEffect(()=>{if(!c){u(n);return}let x=0;const v=setInterval(()=>{if(x>=n.length){clearInterval(v),u(n);return}const y=n.length>1e3?50:n.length>500?25:10;u(n.slice(0,x+y)),x+=y},10);return()=>clearInterval(v)},[n,c]),f},Qe=({text:n,shouldAnimate:c})=>{const f=os(n,c);if(!f)return t.jsx("span",{className:"animate-pulse",children:"..."});const u=f.split(/(```[\s\S]*?```)/g),x=z[P]||z.medium,v=be[Z]||be.relaxed;return t.jsx("div",{className:`whitespace-pre-wrap ${v.class} ${x.message}`,children:u.map((j,y)=>{if(j.startsWith("```")&&j.endsWith("```")){const S=j.match(/^```(\w+)?\n([\s\S]*)```$/),$=S?S[1]:"",fe=S?S[2]:j.slice(3,-3);return t.jsxs("div",{className:"my-3 rounded-lg bg-slate-800 text-slate-100 overflow-hidden shadow-sm border border-slate-700",children:[t.jsxs("div",{className:"flex items-center justify-between px-3 py-1.5 bg-slate-900/50 text-slate-400 border-b border-white/10 select-none",children:[t.jsx("span",{className:`uppercase font-semibold tracking-wider ${x.meta}`,children:$||"CODE"}),t.jsxs("button",{onClick:st=>{st.stopPropagation(),Ee(fe.trim())},className:"hover:text-white flex items-center gap-1.5 transition-colors text-xs","aria-label":"Copy code",children:[t.jsx(xe,{className:"h-3 w-3"})," Copy"]})]}),t.jsx("pre",{className:`p-3 overflow-x-auto font-mono ${x.code} scrollbar-thin scrollbar-thumb-slate-600 scrollbar-track-transparent`,children:t.jsx("code",{children:fe.trim()})})]},y)}return t.jsx("span",{children:j},y)})})},me=async()=>{if(!l.trim())return;const n={id:Date.now(),text:l,sender:"user",createdAt:new Date().toISOString()};r(u=>[...u,n]),d(""),le(!0),Le({id:n.id,text:n.text});const c=ts(n.text);if(c){setTimeout(()=>{const u={id:Date.now()+1,text:c.answer,sender:"guru",link:c.link,createdAt:new Date().toISOString()};r(x=>[...x,u]),Q(u.id),le(!1)},600);return}const f=m.trim();if(f){try{const u=new cn(f);let x,v;for(const _ of Yt)try{x=u.getGenerativeModel({model:_,systemInstruction:"You are an expert Power BI Developer and Data Analyst for the US Department of Health and Human Services (HHS). Help the user with their questions. If it is a general question, answer it normally but try to pivot back to data, Power BI, or HHS context if relevant. If it involves DAX, provide code snippets."});break}catch(Ie){v=Ie;continue}if(!x)throw v||new Error("No compatible Gemini model found");const y=[...i.filter(_=>!_.isError&&!_.isSystem).map(_=>({role:_.sender==="user"?"user":"model",parts:[{text:_.text}]})),{role:"user",parts:[{text:n.text}]}],S=3e4,$=new Promise((_,Ie)=>setTimeout(()=>Ie(new Error("Request timeout")),S)),fe=x.generateContent({contents:y,generationConfig:{maxOutputTokens:1e3}}),rs=(await(await Promise.race([fe,$])).response).text(),nt={id:Date.now()+1,text:rs,sender:"guru",createdAt:new Date().toISOString()};r(_=>[..._,nt]),Q(nt.id)}catch(u){console.error("AI Connection Error:",u.message);const x=u.message?.includes("API_KEY")||u.message?.includes("PERMISSION_DENIED")||u.message?.includes("INVALID_ARGUMENT"),v=u.message?.includes("timeout")||u.message?.includes("Timeout"),j=u.message?.includes("network")||u.message?.includes("fetch");x&&(q("error"),V("Invalid API key or insufficient permissions"));let y;x?y="I couldn't connect to the AI service with the current access code. Please update your API key in settings, or I can help with local knowledge about DAX and Power BI.":v?y="The AI service is taking too long to respond. This can happen on slower connections. Please try again, or I can help with local knowledge about DAX and Power BI.":j?y="I'm having trouble reaching the AI service. Please check your internet connection and try again, or I can help with local knowledge about DAX and Power BI.":y="I'm having trouble connecting to the AI service right now. Let me help with what I know about DAX and Power BI instead.";const S={id:Date.now()+1,text:y,sender:"guru",isError:!0,createdAt:new Date().toISOString()};r($=>[...$,S]),Q(S.id)}finally{le(!1)}return}setTimeout(()=>{const u={id:Date.now()+1,text:"I don't have an answer for that in my local knowledge base. To unlock full AI capabilities, please configure the AI Access Code in settings.",sender:"guru",isSystem:!0,createdAt:new Date().toISOString()};r(x=>[...x,u]),Q(u.id),le(!1)},600)},Se=!!ke(),is=!!ye&&!Se,U=m?ce==="connected"?{text:Oe?`AI Connected (${Oe})`:"AI Connected",className:"bg-emerald-100 text-emerald-700"}:ce==="connecting"?{text:"Verifying Access Code",className:"bg-sky-100 text-sky-700"}:ce==="error"?{text:"Connection Error",className:"bg-rose-100 text-rose-700"}:null:null,Ze=!E,et=X?{width:`${Me}px`}:void 0,tt=t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center justify-between mb-3 gap-2",children:[t.jsxs("div",{children:[t.jsxs("p",{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:[t.jsx(js,{className:"h-4 w-4 text-brand-500"}),"Session Notes"]}),t.jsx("p",{className:"text-xs text-slate-500",children:"Capture insights or follow-ups"})]}),t.jsxs("div",{className:"flex gap-1",children:[t.jsx("button",{onClick:ss,className:"p-2 text-slate-400 hover:text-brand-600 hover:bg-brand-50 rounded transition-colors",title:"Copy notes","aria-label":"Copy notes",children:t.jsx(xe,{className:"h-4 w-4"})}),t.jsx("button",{onClick:ns,className:"p-2 text-slate-400 hover:text-rose-600 hover:bg-rose-50 rounded transition-colors",title:"Clear notes","aria-label":"Clear notes",children:t.jsx(ps,{className:"h-4 w-4"})})]})]}),t.jsx("textarea",{value:D,onChange:n=>Ce(n.target.value),placeholder:"Capture project context, action items, or next steps...",className:"input-field flex-1 min-h-[200px] resize-none"}),t.jsxs("p",{className:"text-[11px] text-slate-400 text-right mt-2",children:["Autosaved locally • ",D.trim().length," chars"]})]});return De?t.jsxs("div",{className:"fixed inset-0 z-50 bg-white flex flex-col",children:[t.jsxs("div",{className:"bg-slate-50 border-b border-slate-200 px-4 py-3 flex flex-wrap items-center justify-between gap-3",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(F,{className:"h-5 w-5 text-brand-600"}),t.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Power BI Guru"}),U&&t.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full font-medium ${U.className}`,children:U.text})]}),t.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[t.jsxs("button",{onClick:a,"aria-pressed":s,"aria-label":s?"Show sidebar":"Hide sidebar",className:`hidden lg:flex p-2 rounded-lg text-sm font-medium items-center gap-2 border transition-colors ${s?"border-slate-200 text-slate-600 hover:bg-slate-100":"bg-emerald-50 text-emerald-700 border-emerald-100"}`,title:s?"Show sidebar":"Hide sidebar",children:[s?t.jsx(ht,{className:"h-4 w-4"}):t.jsx(ut,{className:"h-4 w-4"}),t.jsx("span",{className:"hidden xl:inline",children:s?"Show sidebar":"Hide sidebar"})]}),t.jsxs("button",{onClick:qe,"aria-pressed":!E,"aria-label":E?"Show notes panel":"Hide notes panel",className:`p-2 rounded-lg text-sm font-medium flex items-center gap-2 border transition-colors ${E?"border-slate-200 text-slate-600 hover:bg-slate-100":"bg-brand-50 text-brand-700 border-brand-100"}`,children:[E?t.jsx(ft,{className:"h-4 w-4"}):t.jsx(mt,{className:"h-4 w-4"}),t.jsx("span",{className:"hidden sm:inline",children:E?"Show notes":"Hide notes"})]}),t.jsx("button",{onClick:Ve,className:"p-2 hover:bg-slate-200 rounded-lg transition-colors text-slate-600",title:"Exit Fullscreen",children:t.jsx(Cs,{className:"h-5 w-5"})})]})]}),t.jsx("div",{className:"flex-1 flex flex-col overflow-hidden",children:t.jsxs("div",{ref:R,className:"flex-1 flex flex-col gap-4 lg:flex-row lg:items-stretch px-4 pb-4 pt-2 overflow-hidden",children:[t.jsxs("div",{className:"flex-1 flex flex-col min-w-0 bg-white relative border border-slate-200 rounded-xl shadow-sm",children:[t.jsxs("div",{className:"px-4 py-2 border-b border-slate-100 bg-white flex items-center gap-2 overflow-x-auto shrink-0",children:[t.jsxs("div",{className:"flex items-center gap-2 text-xs font-semibold uppercase text-slate-500 whitespace-nowrap",children:[t.jsx(xt,{className:"h-3 w-3 text-brand-500"}),"Quick prompts"]}),t.jsx("div",{className:"flex gap-2",children:Mt.map(n=>t.jsx("button",{onClick:()=>Be(n.value),className:"flex-shrink-0 px-3 py-1 text-xs bg-slate-100 text-slate-700 rounded-full hover:bg-brand-50 hover:text-brand-700 transition-colors whitespace-nowrap",children:n.label},n.label))}),t.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[t.jsx("button",{onClick:()=>Ge(!K),className:`p-1.5 rounded transition-colors flex items-center gap-1 ${K?"bg-brand-100 text-brand-700":"text-slate-400 hover:text-slate-600 hover:bg-slate-200"}`,title:"Text & Style Settings","aria-label":"Text style settings",children:t.jsx(pe,{className:"h-4 w-4"})}),t.jsx("button",{onClick:Fe,className:"p-1.5 text-slate-400 hover:text-slate-600 hover:bg-slate-200 rounded transition-colors",title:"Export chat","aria-label":"Export chat",children:t.jsx(rt,{className:"h-4 w-4"})}),t.jsx("button",{onClick:Ue,className:"p-1.5 text-slate-400 hover:text-red-500 hover:bg-red-50 rounded transition-colors",title:"Clear chat","aria-label":"Clear chat",children:t.jsx(at,{className:"h-4 w-4"})})]})]}),t.jsx(B,{children:K&&t.jsx(O.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden border-b border-slate-200",children:t.jsxs("div",{className:"px-4 py-3 bg-gradient-to-br from-brand-50 to-slate-50",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[t.jsx(pe,{className:"h-4 w-4 text-brand-600"}),t.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"Text & Style Settings"})]}),t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 max-w-3xl",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-slate-700 mb-2",children:"Font Size"}),t.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.entries(z).map(([n,c])=>t.jsxs("button",{onClick:()=>He(n),className:`px-3 py-2 text-xs rounded-lg border transition-all ${P===n?"bg-brand-600 text-white border-brand-600 shadow-md":"bg-white text-slate-700 border-slate-200 hover:border-brand-300 hover:bg-brand-50"}`,children:[t.jsx("div",{className:"font-semibold",children:c.label}),t.jsx("div",{className:"text-[10px] opacity-75",children:c.description})]},n))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-slate-700 mb-2",children:"Line Spacing"}),t.jsx("div",{className:"grid grid-cols-1 gap-2",children:Object.entries(be).map(([n,c])=>t.jsx("button",{onClick:()=>$e(n),className:`px-3 py-2 text-xs rounded-lg border transition-all ${Z===n?"bg-brand-600 text-white border-brand-600 shadow-md":"bg-white text-slate-700 border-slate-200 hover:border-brand-300 hover:bg-brand-50"}`,children:c.label},n))})]})]}),t.jsxs("p",{className:"text-xs text-slate-500 mt-3 flex items-center gap-1",children:[t.jsx(F,{className:"h-3 w-3"}),"Settings are saved automatically and persist across sessions"]})]})})}),t.jsxs("div",{ref:ve,className:`flex-1 overflow-y-auto p-4 md:p-8 ${We} relative`,children:[i.map(n=>t.jsx(O.div,{id:`message-${n.id}`,initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:`flex ${n.sender==="user"?"justify-end":"justify-start"}`,children:t.jsxs("div",{className:`max-w-[90%] md:max-w-[70%] rounded-2xl ${Xe} group relative shadow-sm ${n.sender==="user"?"bg-brand-600 text-white rounded-br-none":n.isSystem?"bg-amber-50 text-amber-800 border border-amber-100":"bg-slate-100 text-slate-800 rounded-bl-none"} ${n.id===ue?"ring-2 ring-brand-200 shadow-brand-200/60":""}`,children:[t.jsx("button",{onClick:()=>Ee(n.text),className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity text-slate-400 hover:text-brand-600 bg-white/20 p-1 rounded",title:"Copy message","aria-label":"Copy message",children:t.jsx(xe,{className:"h-3 w-3"})}),n.sender==="guru"&&!n.isSystem&&t.jsx("button",{onClick:()=>je(n.text),className:"absolute top-2 right-12 opacity-0 group-hover:opacity-100 transition-opacity text-slate-400 hover:text-brand-600 bg-white/20 p-1 rounded",title:"Save to notes","aria-label":"Save to notes",children:t.jsx(_e,{className:"h-3 w-3"})}),t.jsxs("div",{className:`flex items-center justify-between mb-1 opacity-75 ${Je}`,children:[t.jsxs("div",{className:"flex items-center gap-2",children:[n.sender==="user"?t.jsx(ot,{className:"h-3 w-3"}):t.jsx(F,{className:"h-3 w-3"}),t.jsx("span",{className:"uppercase font-bold tracking-wider",children:n.sender})]}),ee(n)&&t.jsx("span",{className:"opacity-75",children:ee(n)})]}),t.jsx(Qe,{text:n.text,shouldAnimate:n.id===ue&&n.sender==="guru"&&!n.isSystem}),n.link&&t.jsx("div",{className:"mt-3 pt-3 border-t border-black/10",children:t.jsxs("a",{href:`#${n.link}`,className:"text-xs font-bold flex items-center gap-1 hover:underline",children:["View Resource ",t.jsx(lt,{className:"h-3 w-3"})]})})]})},n.id)),t.jsx(B,{children:re&&t.jsx(O.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"flex justify-start",children:t.jsxs("div",{className:"bg-slate-100 rounded-2xl rounded-bl-none p-4 flex gap-1",children:[t.jsx("span",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce"}),t.jsx("span",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce delay-75"}),t.jsx("span",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce delay-150"})]})})}),t.jsx("div",{ref:de})]}),t.jsxs("div",{className:"p-4 bg-slate-50 border-t border-slate-200 shrink-0",children:[t.jsxs("div",{className:"max-w-4xl mx-auto w-full flex gap-2",children:[t.jsx("textarea",{ref:W,value:l,onChange:n=>d(n.target.value),onKeyDown:n=>{n.key==="Enter"&&!n.shiftKey&&(n.preventDefault(),me())},placeholder:"Ask anything about Power BI... (Shift+Enter for new line)",className:"input-field flex-1 shadow-sm resize-none min-h-[48px] max-h-[200px]",rows:1}),t.jsx("button",{onClick:me,disabled:!l.trim()||re,className:"btn-primary disabled:opacity-50 disabled:cursor-not-allowed px-6","aria-label":"Send message",children:t.jsx(ct,{className:"h-5 w-5"})})]}),!m&&t.jsxs("p",{className:"text-xs text-slate-400 mt-2 text-center",children:["Running in ",t.jsx("span",{className:"font-semibold text-brand-600",children:"Local Knowledge Mode"}),". Add an Access Code for full AI features."]})]})]}),Ze&&t.jsxs("div",{className:"flex flex-col gap-4 lg:gap-0 lg:flex-row shrink-0 w-full lg:w-auto",children:[X&&t.jsx("div",{className:"hidden lg:flex items-center justify-center w-5 cursor-col-resize select-none text-slate-400 hover:bg-slate-100 hover:text-brand-500 transition-colors -ml-2.5 z-10",role:"separator","aria-label":"Resize session notes panel","aria-orientation":"vertical",tabIndex:0,onPointerDown:Ye,onKeyDown:ze,title:"Drag to resize notes",children:t.jsx("div",{className:"flex flex-col items-center gap-1 bg-white/80 rounded-full px-1 py-3 shadow-sm border border-slate-200",children:t.jsx(dt,{className:"h-4 w-4"})})}),t.jsx("div",{className:"border border-slate-200 bg-slate-50 rounded-xl shadow-inner p-4 sm:p-5 flex flex-col w-full lg:w-auto transition-[width] duration-200 max-h-[300px] lg:max-h-none",style:et,children:tt})]})]})})]}):t.jsxs("div",{className:"flex flex-col gap-4 min-h-[calc(100vh-10rem)] sm:min-h-[calc(100vh-8rem)]",children:[t.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-3 mb-2 sm:mb-4",children:[t.jsxs("div",{children:[t.jsxs("h2",{className:"text-xl sm:text-2xl font-bold text-slate-900 flex flex-wrap items-center gap-2",children:[t.jsx(F,{className:"h-5 w-5 sm:h-6 sm:w-6 text-brand-600"}),"Power BI Guru",U&&t.jsx("span",{className:`text-[10px] sm:text-xs px-2 py-0.5 rounded-full font-medium ${U.className}`,children:U.text})]}),t.jsx("p",{className:"text-sm sm:text-base text-slate-600 mt-1",children:"Your AI assistant for DAX, Design, and Strategy."}),m&&t.jsx("p",{className:"mt-1 text-xs text-slate-500",children:p?"Using your personal Gemini access code.":Se?"Using the built-in HHS Gemini access code.":"Using the currently stored Gemini access code."}),!m&&is&&t.jsxs("p",{className:"mt-1 text-xs text-amber-600 flex items-center gap-1",children:[t.jsx(it,{className:"h-3 w-3"}),"Built-in cloud access is limited to approved internal domains. Add your own access code in settings to chat from this site."]}),ce==="error"&&m&&t.jsxs("p",{className:"mt-1 text-sm text-rose-600 flex items-center gap-1",children:[t.jsx(it,{className:"h-4 w-4"}),t.jsx("span",{children:zt||"Unable to connect to the AI. Update the access code in settings."})]})]}),t.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[t.jsxs("button",{onClick:a,"aria-pressed":s,"aria-label":s?"Show sidebar":"Hide sidebar",className:`hidden lg:flex p-2.5 sm:p-2 rounded-lg text-sm font-medium items-center gap-2 border transition-colors ${s?"border-slate-200 text-slate-600 hover:bg-slate-100":"bg-emerald-50 text-emerald-700 border-emerald-100"}`,title:s?"Show sidebar":"Hide sidebar",children:[s?t.jsx(ht,{className:"h-4 w-4"}):t.jsx(ut,{className:"h-4 w-4"}),t.jsx("span",{className:"hidden xl:inline",children:s?"Show sidebar":"Hide sidebar"})]}),t.jsxs("button",{onClick:qe,"aria-pressed":!E,"aria-label":E?"Show notes panel":"Hide notes panel",className:`p-2.5 sm:p-2 rounded-lg text-xs sm:text-sm font-medium flex items-center gap-1.5 sm:gap-2 border transition-colors ${E?"border-slate-200 text-slate-600 hover:bg-slate-100":"bg-brand-50 text-brand-700 border-brand-100"}`,children:[E?t.jsx(ft,{className:"h-4 w-4"}):t.jsx(mt,{className:"h-4 w-4"}),t.jsx("span",{className:"hidden sm:inline",children:E?"Show notes":"Hide notes"})]}),t.jsx("button",{onClick:Ve,className:"p-2.5 sm:p-2 rounded-lg bg-slate-100 text-slate-600 hover:bg-slate-200 transition-colors",title:"Maximize (Fullscreen Mode)","aria-label":"Maximize (Fullscreen Mode)",children:t.jsx(ws,{className:"h-5 w-5"})}),t.jsx("button",{onClick:()=>k(!b),className:`p-2.5 sm:p-2 rounded-lg transition-colors ${b?"bg-brand-50 text-brand-700":p?"bg-emerald-100 text-emerald-700":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,title:"Manage AI Access Code","aria-label":"Manage AI Access Code",children:t.jsx(Rs,{className:"h-5 w-5"})})]})]}),t.jsx(B,{children:b&&t.jsx(O.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden mb-4",children:t.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-lg p-4",children:[t.jsxs("h3",{className:"font-semibold text-slate-900 mb-2 flex items-center gap-2",children:[t.jsx(ds,{className:"h-4 w-4"})," AI Settings"]}),t.jsx("p",{className:"text-sm text-slate-600 mb-3",children:"Enter your access code to enable full AI chat capabilities."}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("input",{type:"password",value:A,onChange:n=>I(n.target.value),placeholder:"Enter Access Code...",className:"input-field flex-1"}),t.jsx("button",{onClick:Zt,className:"btn-primary",children:"Save & Connect"}),p&&t.jsx("button",{onClick:es,className:"btn-secondary text-red-600 hover:bg-red-50",children:"Clear"})]}),t.jsxs("div",{className:"text-xs text-slate-500 mt-3 space-y-1",children:[t.jsx("p",{children:p?"Currently using your personal Gemini key. Clear to switch back to the built-in HHS access code.":Se?"Using the built-in HHS Gemini key by default. Add your own key if you need to run chats under a personal quota.":"No access code is configured yet. Add one to enable cloud AI responses."}),t.jsx("p",{className:"text-slate-400",children:"Any personal key you add stays in your browser only."})]})]})})}),t.jsxs("div",{ref:R,className:"flex-1 flex flex-col gap-4 lg:flex-row lg:items-stretch overflow-hidden",children:[t.jsxs("div",{className:"flex-1 bg-white border border-slate-200 rounded-xl shadow-sm overflow-hidden flex flex-col relative min-w-0 min-h-[420px]",children:[t.jsxs("div",{className:"bg-slate-50 border-b border-slate-200 px-3 sm:px-4 py-2 sm:py-3 flex flex-wrap items-center gap-3",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(vs,{className:"h-4 w-4 text-slate-500"}),t.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Conversation"}),t.jsxs("span",{className:"text-xs text-slate-500 bg-slate-200 px-2 py-0.5 rounded-full",children:[i.filter(n=>!n.isSystem).length," messages"]})]}),t.jsxs("div",{className:"flex gap-1.5 sm:gap-2 ml-auto",children:[t.jsx("button",{onClick:Fe,className:"p-1.5 text-slate-400 hover:text-slate-600 hover:bg-slate-200 rounded transition-colors",title:"Export chat",children:t.jsx(rt,{className:"h-4 w-4"})}),t.jsx("button",{onClick:Ue,className:"p-1.5 text-slate-400 hover:text-red-500 hover:bg-red-50 rounded transition-colors",title:"Clear chat",children:t.jsx(at,{className:"h-4 w-4"})})]})]}),t.jsxs("div",{className:"px-3 sm:px-4 py-2 sm:py-3 border-b border-slate-100 bg-white flex flex-wrap items-center gap-2",children:[t.jsxs("div",{className:"flex items-center gap-2 text-[10px] sm:text-xs font-semibold uppercase text-slate-500",children:[t.jsx(xt,{className:"h-3 w-3 text-brand-500"}),t.jsx("span",{className:"hidden xs:inline",children:"Quick prompts"})]}),t.jsx("div",{className:"flex flex-wrap gap-1.5 sm:gap-2",children:Mt.map(n=>t.jsx("button",{onClick:()=>Be(n.value),className:"px-2.5 sm:px-3 py-1.5 sm:py-1 text-[11px] sm:text-xs bg-slate-100 text-slate-700 rounded-full hover:bg-brand-50 hover:text-brand-700 transition-colors whitespace-nowrap flex-shrink-0",children:n.label},n.label))}),t.jsxs("div",{className:"ml-auto flex items-center gap-1.5 sm:gap-2",children:[t.jsxs("button",{onClick:()=>Ge(!K),className:`text-[11px] sm:text-xs px-2.5 sm:px-3 py-1.5 sm:py-1 rounded-full border flex items-center gap-1 sm:gap-1.5 ${K?"bg-brand-600 text-white border-brand-600":"border-slate-200 text-slate-600 hover:bg-slate-100"}`,title:"Text & Style Settings","aria-label":"Text & Style Settings",children:[t.jsx(pe,{className:"h-3 w-3"}),t.jsx("span",{className:"hidden sm:inline",children:"Style"})]}),t.jsx("button",{onClick:as,className:`text-[11px] sm:text-xs px-2.5 sm:px-3 py-1.5 sm:py-1 rounded-full border whitespace-nowrap ${J?"bg-brand-600 text-white border-brand-600":"border-slate-200 text-slate-600"}`,"aria-label":J?"Switch to normal mode":"Switch to compact mode",children:J?"Compact":"Normal"})]})]}),t.jsx(B,{children:K&&t.jsx(O.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden border-b border-slate-200",children:t.jsxs("div",{className:"px-3 sm:px-4 py-3 bg-gradient-to-br from-brand-50 to-slate-50",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[t.jsx(pe,{className:"h-4 w-4 text-brand-600"}),t.jsx("h3",{className:"font-semibold text-slate-900 text-sm",children:"Text & Style Settings"})]}),t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-slate-700 mb-2",children:"Font Size"}),t.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.entries(z).map(([n,c])=>t.jsxs("button",{onClick:()=>He(n),className:`px-3 py-2 text-xs rounded-lg border transition-all ${P===n?"bg-brand-600 text-white border-brand-600 shadow-md":"bg-white text-slate-700 border-slate-200 hover:border-brand-300 hover:bg-brand-50"}`,children:[t.jsx("div",{className:"font-semibold",children:c.label}),t.jsx("div",{className:"text-[10px] opacity-75",children:c.description})]},n))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-slate-700 mb-2",children:"Line Spacing"}),t.jsx("div",{className:"grid grid-cols-1 gap-2",children:Object.entries(be).map(([n,c])=>t.jsx("button",{onClick:()=>$e(n),className:`px-3 py-2 text-xs rounded-lg border transition-all ${Z===n?"bg-brand-600 text-white border-brand-600 shadow-md":"bg-white text-slate-700 border-slate-200 hover:border-brand-300 hover:bg-brand-50"}`,children:c.label},n))})]})]}),t.jsxs("p",{className:"text-xs text-slate-500 mt-3 flex items-center gap-1",children:[t.jsx(F,{className:"h-3 w-3"}),"Settings are saved automatically and persist across sessions"]})]})})}),L&&t.jsxs("div",{className:"px-3 sm:px-4 py-2 sm:py-3 border-b border-slate-100 bg-slate-50 flex flex-wrap items-center gap-3",children:[t.jsxs("div",{className:"flex-1 min-w-[240px]",children:[t.jsx("p",{className:"text-xs uppercase font-semibold text-slate-500 tracking-wide",children:"Current question"}),t.jsx("p",{className:"font-medium text-slate-900",children:wn(L.text,160)})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("button",{onClick:()=>Pe(L.id),className:"px-3 py-1.5 text-xs rounded-full bg-white border border-slate-200 hover:border-brand-300 hover:text-brand-600 transition-colors flex items-center gap-1",children:[t.jsx(ms,{className:"h-3 w-3"})," Jump to question"]}),t.jsxs("button",{onClick:()=>je(L.text),className:"px-3 py-1.5 text-xs rounded-full bg-brand-50 text-brand-700 border border-brand-100 flex items-center gap-1",children:[t.jsx(_e,{className:"h-3 w-3"})," Save"]})]})]}),t.jsxs("div",{ref:ve,className:`flex-1 overflow-y-auto p-3 sm:p-4 lg:p-5 ${We} relative`,children:[i.map(n=>t.jsx(O.div,{id:`message-${n.id}`,initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:`flex ${n.sender==="user"?"justify-end":"justify-start"}`,children:t.jsxs("div",{className:`max-w-[80%] rounded-2xl ${Xe} group relative ${n.sender==="user"?"bg-brand-600 text-white rounded-br-none":n.isSystem?"bg-amber-50 text-amber-800 border border-amber-100":"bg-slate-100 text-slate-800 rounded-bl-none"} ${n.id===ue?"ring-2 ring-brand-200 shadow-lg shadow-brand-200/60":""}`,children:[t.jsx("button",{onClick:()=>Ee(n.text),className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity text-slate-400 hover:text-brand-600",title:"Copy message","aria-label":"Copy message",children:t.jsx(xe,{className:"h-4 w-4"})}),n.sender==="guru"&&!n.isSystem&&t.jsx("button",{onClick:()=>je(n.text),className:"absolute top-2 right-10 opacity-0 group-hover:opacity-100 transition-opacity text-slate-400 hover:text-brand-600",title:"Save to notes","aria-label":"Save to notes",children:t.jsx(_e,{className:"h-4 w-4"})}),t.jsxs("div",{className:`flex items-center justify-between mb-1 opacity-75 ${Je}`,children:[t.jsxs("div",{className:"flex items-center gap-2",children:[n.sender==="user"?t.jsx(ot,{className:"h-3 w-3"}):t.jsx(F,{className:"h-3 w-3"}),t.jsx("span",{className:"uppercase font-bold tracking-wider",children:n.sender})]}),ee(n)&&t.jsx("span",{className:"text-slate-400",children:ee(n)})]}),t.jsx(Qe,{text:n.text,shouldAnimate:n.id===ue&&n.sender==="guru"&&!n.isSystem}),n.link&&t.jsx("div",{className:"mt-3 pt-3 border-t border-black/10",children:t.jsxs("a",{href:`#${n.link}`,className:"text-xs font-bold flex items-center gap-1 hover:underline",children:["View Resource ",t.jsx(lt,{className:"h-3 w-3"})]})})]})},n.id)),t.jsx(B,{children:re&&t.jsx(O.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"flex justify-start",children:t.jsxs("div",{className:"bg-slate-100 rounded-2xl rounded-bl-none p-4 flex gap-1",children:[t.jsx("span",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce"}),t.jsx("span",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce delay-75"}),t.jsx("span",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce delay-150"})]})})}),t.jsx("div",{ref:de})]}),t.jsx(B,{children:!qt&&t.jsx(O.button,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},onClick:Ke,className:"absolute bottom-24 right-4 bg-brand-600 text-white p-2 rounded-full shadow-lg hover:bg-brand-700 transition-colors z-10",title:"Scroll to bottom",children:t.jsx(us,{className:"h-4 w-4"})})}),t.jsxs("div",{className:"p-3 sm:p-4 bg-slate-50 border-t border-slate-200",children:[t.jsxs("div",{className:"flex gap-2",children:[t.jsx("textarea",{ref:W,value:l,onChange:n=>d(n.target.value),onKeyDown:n=>{n.key==="Enter"&&!n.shiftKey&&(n.preventDefault(),me())},placeholder:"Ask anything about Power BI...",className:"input-field flex-1 shadow-sm resize-none min-h-[48px] sm:min-h-[44px] max-h-[200px] text-base sm:text-sm",rows:1}),t.jsx("button",{onClick:me,disabled:!l.trim()||re,className:"btn-primary disabled:opacity-50 disabled:cursor-not-allowed min-w-[48px] sm:min-w-[44px]","aria-label":"Send message",children:t.jsx(ct,{className:"h-5 w-5 sm:h-4 sm:w-4"})})]}),t.jsxs("p",{className:"text-[10px] sm:text-xs text-slate-400 mt-2 text-center flex flex-wrap items-center justify-center gap-x-2 gap-y-1",children:[t.jsx("span",{className:"hidden sm:inline",children:"Enter = Send"}),t.jsx("span",{className:"hidden sm:inline",children:"Shift+Enter = New line"}),t.jsx("span",{className:"sm:hidden",children:"Tap Send or press Enter"}),t.jsx("span",{className:"hidden md:inline",children:"Copy buttons appear when you hover a message"})]}),!m&&t.jsxs("p",{className:"text-xs text-slate-400 mt-2 text-center",children:["Running in ",t.jsx("span",{className:"font-semibold text-brand-600",children:"Local Knowledge Mode"}),". Add an Access Code for full AI features."]})]})]}),Ze&&t.jsxs("div",{className:"flex flex-col gap-4 lg:gap-0 lg:flex-row shrink-0 w-full lg:w-auto",children:[X&&t.jsx("div",{className:"hidden lg:flex items-center justify-center w-5 cursor-col-resize select-none text-slate-400 hover:bg-slate-100 hover:text-brand-500 transition-colors -ml-2.5 z-10",role:"separator","aria-label":"Resize session notes panel","aria-orientation":"vertical",tabIndex:0,onPointerDown:Ye,onKeyDown:ze,title:"Drag to resize notes",children:t.jsx("div",{className:"flex flex-col items-center gap-1 bg-white/80 rounded-full px-1 py-3 shadow-sm border border-slate-200",children:t.jsx(dt,{className:"h-4 w-4"})})}),t.jsx("aside",{className:"bg-white border border-slate-200 rounded-xl shadow-sm p-4 sm:p-5 flex flex-col w-full lg:w-auto min-h-[260px] max-h-[300px] lg:max-h-none transition-[width] duration-200",style:et,children:tt})]})]})]})};export{Rn as default};
