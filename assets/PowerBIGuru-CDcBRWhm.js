import{c as v,u as qt,b as Vt,r as h,j as t,d as Fe,T as Ye,m as P,e as qe,A as ce,a as zt}from"./index-jriziVv_.js";import{C as de}from"./copy-CPn21o4_.js";import{D as Ve}from"./download-CSuNf4fH.js";import{D as ze}from"./database-BRqGiLn2.js";import{S as We,K as Wt}from"./send-Cci5Gs_D.js";import{C as Xt}from"./chevron-down-DzL4In5g.js";const Jt=[["path",{d:"M12 17V3",key:"1cwfxf"}],["path",{d:"m6 11 6 6 6-6",key:"12ii2o"}],["path",{d:"M19 21H5",key:"150jfl"}]],Qt=v("arrow-down-to-line",Jt);const Zt=[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}],["line",{x1:"12",x2:"12",y1:"7",y2:"13",key:"1cppfj"}],["line",{x1:"15",x2:"9",y1:"10",y2:"10",key:"1gty7f"}]],ye=v("bookmark-plus",Zt);const es=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],Xe=v("bot",es);const ts=[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21",key:"g5wo59"}],["path",{d:"m5.082 11.09 8.828 8.828",key:"1wx5vj"}]],ss=v("eraser",ts);const ns=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],Je=v("grip-vertical",ns);const os=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],as=v("maximize-2",os);const is=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],rs=v("message-square",is);const ls=[["path",{d:"m14 10 7-7",key:"oa77jy"}],["path",{d:"M20 10h-6V4",key:"mjg0md"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M4 14h6v6",key:"rmj7iw"}]],cs=v("minimize-2",ls);const ds=[["path",{d:"M13.4 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-7.4",key:"re6nr2"}],["path",{d:"M2 6h4",key:"aawbzj"}],["path",{d:"M2 10h4",key:"l0bgd4"}],["path",{d:"M2 14h4",key:"1gsvsf"}],["path",{d:"M2 18h4",key:"1bu2t1"}],["path",{d:"M21.378 5.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"pqwjuv"}]],us=v("notebook-pen",ds);const hs=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"m16 15-3-3 3-3",key:"14y99z"}]],Qe=v("panel-left-close",hs);const fs=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"m14 9 3 3-3 3",key:"8010ee"}]],Ze=v("panel-left-open",fs);const ps=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M15 3v18",key:"14nvp0"}],["path",{d:"m8 9 3 3-3 3",key:"12hl5m"}]],et=v("panel-right-close",ps);const xs=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M15 3v18",key:"14nvp0"}],["path",{d:"m10 15-3-3 3-3",key:"1pgupc"}]],tt=v("panel-right-open",xs);const ms=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],gs=v("settings",ms);const bs=[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]],st=v("wand-sparkles",bs);var nt;(function(e){e.STRING="string",e.NUMBER="number",e.INTEGER="integer",e.BOOLEAN="boolean",e.ARRAY="array",e.OBJECT="object"})(nt||(nt={}));var ot;(function(e){e.LANGUAGE_UNSPECIFIED="language_unspecified",e.PYTHON="python"})(ot||(ot={}));var at;(function(e){e.OUTCOME_UNSPECIFIED="outcome_unspecified",e.OUTCOME_OK="outcome_ok",e.OUTCOME_FAILED="outcome_failed",e.OUTCOME_DEADLINE_EXCEEDED="outcome_deadline_exceeded"})(at||(at={}));const it=["user","model","function","system"];var rt;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(rt||(rt={}));var lt;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(lt||(lt={}));var ct;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(ct||(ct={}));var dt;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER"})(dt||(dt={}));var X;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.OTHER="OTHER"})(X||(X={}));var ut;(function(e){e.TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",e.RETRIEVAL_QUERY="RETRIEVAL_QUERY",e.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",e.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",e.CLASSIFICATION="CLASSIFICATION",e.CLUSTERING="CLUSTERING"})(ut||(ut={}));var ht;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE"})(ht||(ht={}));var ft;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(ft||(ft={}));class w extends Error{constructor(s){super(`[GoogleGenerativeAI Error]: ${s}`)}}class B extends w{constructor(s,o){super(s),this.response=o}}class Et extends w{constructor(s,o,a,i){super(s),this.status=o,this.statusText=a,this.errorDetails=i}}class O extends w{}class St extends w{}const ys="https://generativelanguage.googleapis.com",ws="v1beta",vs="0.24.1",Ns="genai-js";var H;(function(e){e.GENERATE_CONTENT="generateContent",e.STREAM_GENERATE_CONTENT="streamGenerateContent",e.COUNT_TOKENS="countTokens",e.EMBED_CONTENT="embedContent",e.BATCH_EMBED_CONTENTS="batchEmbedContents"})(H||(H={}));class Cs{constructor(s,o,a,i,r){this.model=s,this.task=o,this.apiKey=a,this.stream=i,this.requestOptions=r}toString(){var s,o;const a=((s=this.requestOptions)===null||s===void 0?void 0:s.apiVersion)||ws;let r=`${((o=this.requestOptions)===null||o===void 0?void 0:o.baseUrl)||ys}/${a}/${this.model}:${this.task}`;return this.stream&&(r+="?alt=sse"),r}}function Es(e){const s=[];return e?.apiClient&&s.push(e.apiClient),s.push(`${Ns}/${vs}`),s.join(" ")}async function Ss(e){var s;const o=new Headers;o.append("Content-Type","application/json"),o.append("x-goog-api-client",Es(e.requestOptions)),o.append("x-goog-api-key",e.apiKey);let a=(s=e.requestOptions)===null||s===void 0?void 0:s.customHeaders;if(a){if(!(a instanceof Headers))try{a=new Headers(a)}catch(i){throw new O(`unable to convert customHeaders value ${JSON.stringify(a)} to Headers: ${i.message}`)}for(const[i,r]of a.entries()){if(i==="x-goog-api-key")throw new O(`Cannot set reserved header name ${i}`);if(i==="x-goog-api-client")throw new O(`Header name ${i} can only be set using the apiClient field`);o.append(i,r)}}return o}async function js(e,s,o,a,i,r){const l=new Cs(e,s,o,a,r);return{url:l.toString(),fetchOptions:Object.assign(Object.assign({},ks(r)),{method:"POST",headers:await Ss(l),body:i})}}async function Z(e,s,o,a,i,r={},l=fetch){const{url:c,fetchOptions:p}=await js(e,s,o,a,i,r);return Is(c,p,l)}async function Is(e,s,o=fetch){let a;try{a=await o(e,s)}catch(i){_s(i,e)}return a.ok||await As(a,e),a}function _s(e,s){let o=e;throw o.name==="AbortError"?(o=new St(`Request aborted when fetching ${s.toString()}: ${e.message}`),o.stack=e.stack):e instanceof Et||e instanceof O||(o=new w(`Error fetching from ${s.toString()}: ${e.message}`),o.stack=e.stack),o}async function As(e,s){let o="",a;try{const i=await e.json();o=i.error.message,i.error.details&&(o+=` ${JSON.stringify(i.error.details)}`,a=i.error.details)}catch{}throw new Et(`Error fetching from ${s.toString()}: [${e.status} ${e.statusText}] ${o}`,e.status,e.statusText,a)}function ks(e){const s={};if(e?.signal!==void 0||e?.timeout>=0){const o=new AbortController;e?.timeout>=0&&setTimeout(()=>o.abort(),e.timeout),e?.signal&&e.signal.addEventListener("abort",()=>{o.abort()}),s.signal=o.signal}return s}function ve(e){return e.text=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`),he(e.candidates[0]))throw new B(`${R(e)}`,e);return Rs(e)}else if(e.promptFeedback)throw new B(`Text not available. ${R(e)}`,e);return""},e.functionCall=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),he(e.candidates[0]))throw new B(`${R(e)}`,e);return console.warn("response.functionCall() is deprecated. Use response.functionCalls() instead."),pt(e)[0]}else if(e.promptFeedback)throw new B(`Function call not available. ${R(e)}`,e)},e.functionCalls=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),he(e.candidates[0]))throw new B(`${R(e)}`,e);return pt(e)}else if(e.promptFeedback)throw new B(`Function call not available. ${R(e)}`,e)},e}function Rs(e){var s,o,a,i;const r=[];if(!((o=(s=e.candidates)===null||s===void 0?void 0:s[0].content)===null||o===void 0)&&o.parts)for(const l of(i=(a=e.candidates)===null||a===void 0?void 0:a[0].content)===null||i===void 0?void 0:i.parts)l.text&&r.push(l.text),l.executableCode&&r.push("\n```"+l.executableCode.language+`
`+l.executableCode.code+"\n```\n"),l.codeExecutionResult&&r.push("\n```\n"+l.codeExecutionResult.output+"\n```\n");return r.length>0?r.join(""):""}function pt(e){var s,o,a,i;const r=[];if(!((o=(s=e.candidates)===null||s===void 0?void 0:s[0].content)===null||o===void 0)&&o.parts)for(const l of(i=(a=e.candidates)===null||a===void 0?void 0:a[0].content)===null||i===void 0?void 0:i.parts)l.functionCall&&r.push(l.functionCall);if(r.length>0)return r}const Os=[X.RECITATION,X.SAFETY,X.LANGUAGE];function he(e){return!!e.finishReason&&Os.includes(e.finishReason)}function R(e){var s,o,a;let i="";if((!e.candidates||e.candidates.length===0)&&e.promptFeedback)i+="Response was blocked",!((s=e.promptFeedback)===null||s===void 0)&&s.blockReason&&(i+=` due to ${e.promptFeedback.blockReason}`),!((o=e.promptFeedback)===null||o===void 0)&&o.blockReasonMessage&&(i+=`: ${e.promptFeedback.blockReasonMessage}`);else if(!((a=e.candidates)===null||a===void 0)&&a[0]){const r=e.candidates[0];he(r)&&(i+=`Candidate was blocked due to ${r.finishReason}`,r.finishMessage&&(i+=`: ${r.finishMessage}`))}return i}function J(e){return this instanceof J?(this.v=e,this):new J(e)}function Ms(e,s,o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a=o.apply(e,s||[]),i,r=[];return i={},l("next"),l("throw"),l("return"),i[Symbol.asyncIterator]=function(){return this},i;function l(m){a[m]&&(i[m]=function(g){return new Promise(function(y,_){r.push([m,g,y,_])>1||c(m,g)})})}function c(m,g){try{p(a[m](g))}catch(y){S(r[0][3],y)}}function p(m){m.value instanceof J?Promise.resolve(m.value.v).then(N,I):S(r[0][2],m)}function N(m){c("next",m)}function I(m){c("throw",m)}function S(m,g){m(g),r.shift(),r.length&&c(r[0][0],r[0][1])}}const xt=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;function Ts(e){const s=e.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0})),o=$s(s),[a,i]=o.tee();return{stream:Ls(a),response:Ds(i)}}async function Ds(e){const s=[],o=e.getReader();for(;;){const{done:a,value:i}=await o.read();if(a)return ve(Hs(s));s.push(i)}}function Ls(e){return Ms(this,arguments,function*(){const o=e.getReader();for(;;){const{value:a,done:i}=yield J(o.read());if(i)break;yield yield J(ve(a))}})}function $s(e){const s=e.getReader();return new ReadableStream({start(a){let i="";return r();function r(){return s.read().then(({value:l,done:c})=>{if(c){if(i.trim()){a.error(new w("Failed to parse stream"));return}a.close();return}i+=l;let p=i.match(xt),N;for(;p;){try{N=JSON.parse(p[1])}catch{a.error(new w(`Error parsing JSON response: "${p[1]}"`));return}a.enqueue(N),i=i.substring(p[0].length),p=i.match(xt)}return r()}).catch(l=>{let c=l;throw c.stack=l.stack,c.name==="AbortError"?c=new St("Request aborted when reading from the stream"):c=new w("Error reading from the stream"),c})}}})}function Hs(e){const s=e[e.length-1],o={promptFeedback:s?.promptFeedback};for(const a of e){if(a.candidates){let i=0;for(const r of a.candidates)if(o.candidates||(o.candidates=[]),o.candidates[i]||(o.candidates[i]={index:i}),o.candidates[i].citationMetadata=r.citationMetadata,o.candidates[i].groundingMetadata=r.groundingMetadata,o.candidates[i].finishReason=r.finishReason,o.candidates[i].finishMessage=r.finishMessage,o.candidates[i].safetyRatings=r.safetyRatings,r.content&&r.content.parts){o.candidates[i].content||(o.candidates[i].content={role:r.content.role||"user",parts:[]});const l={};for(const c of r.content.parts)c.text&&(l.text=c.text),c.functionCall&&(l.functionCall=c.functionCall),c.executableCode&&(l.executableCode=c.executableCode),c.codeExecutionResult&&(l.codeExecutionResult=c.codeExecutionResult),Object.keys(l).length===0&&(l.text=""),o.candidates[i].content.parts.push(l)}i++}a.usageMetadata&&(o.usageMetadata=a.usageMetadata)}return o}async function jt(e,s,o,a){const i=await Z(s,H.STREAM_GENERATE_CONTENT,e,!0,JSON.stringify(o),a);return Ts(i)}async function It(e,s,o,a){const r=await(await Z(s,H.GENERATE_CONTENT,e,!1,JSON.stringify(o),a)).json();return{response:ve(r)}}function _t(e){if(e!=null){if(typeof e=="string")return{role:"system",parts:[{text:e}]};if(e.text)return{role:"system",parts:[e]};if(e.parts)return e.role?e:{role:"system",parts:e.parts}}}function Q(e){let s=[];if(typeof e=="string")s=[{text:e}];else for(const o of e)typeof o=="string"?s.push({text:o}):s.push(o);return Gs(s)}function Gs(e){const s={role:"user",parts:[]},o={role:"function",parts:[]};let a=!1,i=!1;for(const r of e)"functionResponse"in r?(o.parts.push(r),i=!0):(s.parts.push(r),a=!0);if(a&&i)throw new w("Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.");if(!a&&!i)throw new w("No content is provided for sending chat message.");return a?s:o}function Us(e,s){var o;let a={model:s?.model,generationConfig:s?.generationConfig,safetySettings:s?.safetySettings,tools:s?.tools,toolConfig:s?.toolConfig,systemInstruction:s?.systemInstruction,cachedContent:(o=s?.cachedContent)===null||o===void 0?void 0:o.name,contents:[]};const i=e.generateContentRequest!=null;if(e.contents){if(i)throw new O("CountTokensRequest must have one of contents or generateContentRequest, not both.");a.contents=e.contents}else if(i)a=Object.assign(Object.assign({},a),e.generateContentRequest);else{const r=Q(e);a.contents=[r]}return{generateContentRequest:a}}function mt(e){let s;return e.contents?s=e:s={contents:[Q(e)]},e.systemInstruction&&(s.systemInstruction=_t(e.systemInstruction)),s}function Ks(e){return typeof e=="string"||Array.isArray(e)?{content:Q(e)}:e}const gt=["text","inlineData","functionCall","functionResponse","executableCode","codeExecutionResult"],Ps={user:["text","inlineData"],function:["functionResponse"],model:["text","functionCall","executableCode","codeExecutionResult"],system:["text"]};function Bs(e){let s=!1;for(const o of e){const{role:a,parts:i}=o;if(!s&&a!=="user")throw new w(`First content should be with role 'user', got ${a}`);if(!it.includes(a))throw new w(`Each item should include role field. Got ${a} but valid roles are: ${JSON.stringify(it)}`);if(!Array.isArray(i))throw new w("Content should have 'parts' property with an array of Parts");if(i.length===0)throw new w("Each Content should have at least one part");const r={text:0,inlineData:0,functionCall:0,functionResponse:0,fileData:0,executableCode:0,codeExecutionResult:0};for(const c of i)for(const p of gt)p in c&&(r[p]+=1);const l=Ps[a];for(const c of gt)if(!l.includes(c)&&r[c]>0)throw new w(`Content with role '${a}' can't contain '${c}' part`);s=!0}}function bt(e){var s;if(e.candidates===void 0||e.candidates.length===0)return!1;const o=(s=e.candidates[0])===null||s===void 0?void 0:s.content;if(o===void 0||o.parts===void 0||o.parts.length===0)return!1;for(const a of o.parts)if(a===void 0||Object.keys(a).length===0||a.text!==void 0&&a.text==="")return!1;return!0}const yt="SILENT_ERROR";class Fs{constructor(s,o,a,i={}){this.model=o,this.params=a,this._requestOptions=i,this._history=[],this._sendPromise=Promise.resolve(),this._apiKey=s,a?.history&&(Bs(a.history),this._history=a.history)}async getHistory(){return await this._sendPromise,this._history}async sendMessage(s,o={}){var a,i,r,l,c,p;await this._sendPromise;const N=Q(s),I={safetySettings:(a=this.params)===null||a===void 0?void 0:a.safetySettings,generationConfig:(i=this.params)===null||i===void 0?void 0:i.generationConfig,tools:(r=this.params)===null||r===void 0?void 0:r.tools,toolConfig:(l=this.params)===null||l===void 0?void 0:l.toolConfig,systemInstruction:(c=this.params)===null||c===void 0?void 0:c.systemInstruction,cachedContent:(p=this.params)===null||p===void 0?void 0:p.cachedContent,contents:[...this._history,N]},S=Object.assign(Object.assign({},this._requestOptions),o);let m;return this._sendPromise=this._sendPromise.then(()=>It(this._apiKey,this.model,I,S)).then(g=>{var y;if(bt(g.response)){this._history.push(N);const _=Object.assign({parts:[],role:"model"},(y=g.response.candidates)===null||y===void 0?void 0:y[0].content);this._history.push(_)}else{const _=R(g.response);_&&console.warn(`sendMessage() was unsuccessful. ${_}. Inspect response object for details.`)}m=g}).catch(g=>{throw this._sendPromise=Promise.resolve(),g}),await this._sendPromise,m}async sendMessageStream(s,o={}){var a,i,r,l,c,p;await this._sendPromise;const N=Q(s),I={safetySettings:(a=this.params)===null||a===void 0?void 0:a.safetySettings,generationConfig:(i=this.params)===null||i===void 0?void 0:i.generationConfig,tools:(r=this.params)===null||r===void 0?void 0:r.tools,toolConfig:(l=this.params)===null||l===void 0?void 0:l.toolConfig,systemInstruction:(c=this.params)===null||c===void 0?void 0:c.systemInstruction,cachedContent:(p=this.params)===null||p===void 0?void 0:p.cachedContent,contents:[...this._history,N]},S=Object.assign(Object.assign({},this._requestOptions),o),m=jt(this._apiKey,this.model,I,S);return this._sendPromise=this._sendPromise.then(()=>m).catch(g=>{throw new Error(yt)}).then(g=>g.response).then(g=>{if(bt(g)){this._history.push(N);const y=Object.assign({},g.candidates[0].content);y.role||(y.role="model"),this._history.push(y)}else{const y=R(g);y&&console.warn(`sendMessageStream() was unsuccessful. ${y}. Inspect response object for details.`)}}).catch(g=>{g.message!==yt&&console.error(g)}),m}}async function Ys(e,s,o,a){return(await Z(s,H.COUNT_TOKENS,e,!1,JSON.stringify(o),a)).json()}async function qs(e,s,o,a){return(await Z(s,H.EMBED_CONTENT,e,!1,JSON.stringify(o),a)).json()}async function Vs(e,s,o,a){const i=o.requests.map(l=>Object.assign(Object.assign({},l),{model:s}));return(await Z(s,H.BATCH_EMBED_CONTENTS,e,!1,JSON.stringify({requests:i}),a)).json()}class wt{constructor(s,o,a={}){this.apiKey=s,this._requestOptions=a,o.model.includes("/")?this.model=o.model:this.model=`models/${o.model}`,this.generationConfig=o.generationConfig||{},this.safetySettings=o.safetySettings||[],this.tools=o.tools,this.toolConfig=o.toolConfig,this.systemInstruction=_t(o.systemInstruction),this.cachedContent=o.cachedContent}async generateContent(s,o={}){var a;const i=mt(s),r=Object.assign(Object.assign({},this._requestOptions),o);return It(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(a=this.cachedContent)===null||a===void 0?void 0:a.name},i),r)}async generateContentStream(s,o={}){var a;const i=mt(s),r=Object.assign(Object.assign({},this._requestOptions),o);return jt(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(a=this.cachedContent)===null||a===void 0?void 0:a.name},i),r)}startChat(s){var o;return new Fs(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(o=this.cachedContent)===null||o===void 0?void 0:o.name},s),this._requestOptions)}async countTokens(s,o={}){const a=Us(s,{model:this.model,generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:this.cachedContent}),i=Object.assign(Object.assign({},this._requestOptions),o);return Ys(this.apiKey,this.model,a,i)}async embedContent(s,o={}){const a=Ks(s),i=Object.assign(Object.assign({},this._requestOptions),o);return qs(this.apiKey,this.model,a,i)}async batchEmbedContents(s,o={}){const a=Object.assign(Object.assign({},this._requestOptions),o);return Vs(this.apiKey,this.model,s,a)}}class zs{constructor(s){this.apiKey=s}getGenerativeModel(s,o){if(!s.model)throw new w("Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })");return new wt(this.apiKey,s,o)}getGenerativeModelFromCachedContent(s,o,a){if(!s.name)throw new O("Cached content must contain a `name` field.");if(!s.model)throw new O("Cached content must contain a `model` field.");const i=["model","systemInstruction"];for(const l of i)if(o?.[l]&&s[l]&&o?.[l]!==s[l]){if(l==="model"){const c=o.model.startsWith("models/")?o.model.replace("models/",""):o.model,p=s.model.startsWith("models/")?s.model.replace("models/",""):s.model;if(c===p)continue}throw new O(`Different value for "${l}" specified in modelParams (${o[l]}) and cachedContent (${s[l]})`)}const r=Object.assign(Object.assign({},o),{model:s.model,tools:s.tools,toolConfig:s.toolConfig,systemInstruction:s.systemInstruction,cachedContent:s});return new wt(this.apiKey,r,a)}}const Ws=[{keywords:["yoy","year over year","growth"],answer:"For Year-over-Year growth, use the 'YoY Growth %' pattern in the DAX Library. It uses `SAMEPERIODLASTYEAR`.",link:"/dax"},{keywords:["blue","color","hex","brand"],answer:"The official HHS Blue hex code is #005EA2. You can find the full palette in the Style Guide.",link:"/style-guide"},{keywords:["pareto","80/20"],answer:"We have a Pareto Analysis pattern in the DAX Library under 'Advanced Analytics'.",link:"/dax"},{keywords:["font","typography"],answer:"The approved font is 'Source Sans Pro'. See the Style Guide for heading sizes.",link:"/style-guide"},{keywords:["dax","measure","calculation"],answer:"The DAX Library contains patterns for Time Intelligence, Financial Formulas, and more. Check the 'DAX Library' tab.",link:"/dax"}],z=180,we=4e3,Xs=280,W=(e,s,o)=>Math.min(Math.max(e,s),o),Js=()=>typeof window>"u"?360:W(window.innerWidth*.3,z,we),ue=()=>({id:"welcome",text:"Hi, I'm your Analytics Assistant. Ask me about DAX, HHS Branding, or data strategy.",sender:"bot",isSystem:!0,createdAt:new Date().toISOString()}),vt=[{label:"Generate DAX",value:"Create a reusable DAX measure for year-over-year revenue with clear comments."},{label:"Explain Visual",value:"Explain how to design an executive KPI card for Power BI with HHS branding guidance."},{label:"Build Checklist",value:"Give me a pre-publish checklist for a Power BI report destined for leadership review."},{label:"Debug Measure",value:"Help me troubleshoot why my DAX measure is returning blank values."}],Nt="guru_session_notes",Ct="guru_messages",At=["gemini-2.5-flash","gemini-2.0-flash","gemini-1.5-flash","gemini-pro"],Qs=["v1beta","v1"],Zs=At[0],fe="AIzaSyDwiE6kUBveR6ncuUlphCbdK2EGqeLnMXY".trim()||"",en=()=>{if(typeof window>"u")return"";const e=window.localStorage.getItem("gemini_api_key");return e?e.trim():""},tn=()=>{const e=en();return e?{key:e,source:"custom"}:fe?{key:fe,source:"project"}:{key:"",source:"none"}},sn=(e,s=120)=>e?e.length>s?`${e.slice(0,s)}…`:e:"",dn=()=>{const{addToast:e}=qt(),{isSidebarCollapsed:s,toggleSidebar:o}=Vt(),a=h.useRef(tn()),[i,r]=h.useState(()=>{if(typeof window>"u")return[ue()];try{const n=window.localStorage.getItem(Ct);return n?JSON.parse(n):[ue()]}catch(n){return console.error("Failed to parse messages",n),[ue()]}}),[l,c]=h.useState(""),[p,N]=h.useState(a.current.key),[I,S]=h.useState(a.current.source==="custom"?a.current.key:""),[m,g]=h.useState(a.current.source==="custom"),[y,_]=h.useState(!1),[ee,te]=h.useState(!1),[se,M]=h.useState(a.current.key?"connecting":"idle"),[kt,T]=h.useState(""),[Ne,ne]=h.useState(null),oe=h.useRef(null),pe=h.useRef(null),[Rt,Ot]=h.useState(!0),F=h.useRef(null),k=h.useRef(null),[Ce,xe]=h.useState(()=>Js()),[C,Mt]=h.useState(!1),[Y,Tt]=h.useState(()=>typeof window>"u"?!1:window.innerWidth>=1024),[D,me]=h.useState(()=>typeof window>"u"?"":window.localStorage.getItem(Nt)||""),[G,Dt]=h.useState(!1),[Ee,Lt]=h.useState(!1),[L,Se]=h.useState(null),[ae,q]=h.useState(null),ie=h.useCallback(()=>{if(!k.current||typeof window>"u")return we;const n=window.getComputedStyle(k.current),d=parseFloat(n.columnGap||n.gap||"0")||0,u=k.current.getBoundingClientRect().width-d-Xs;return W(u,z,we)},[k]),$=h.useCallback(()=>{if(typeof window>"u")return;const n=window.innerWidth>=1024;if(Tt(n),!n)return;const d=ie();xe(x=>W(x,z,d))},[ie]);h.useEffect(()=>{},[]),h.useEffect(()=>{if($(),!(typeof window>"u"))return window.addEventListener("resize",$),()=>window.removeEventListener("resize",$)},[$]),h.useEffect(()=>{$()},[Ee,$]),h.useEffect(()=>{typeof window>"u"||window.localStorage.setItem(Ct,JSON.stringify(i))},[i]);const je=n=>{if(!n)return;const d=document.getElementById(`message-${n}`);d&&d.scrollIntoView({behavior:"smooth",block:"start"})};h.useEffect(()=>{const n=i[i.length-1];if(n?.sender==="bot"&&!n.isSystem&&L?.id){je(L.id);return}oe.current?.scrollIntoView({behavior:"smooth"})},[i,L]),h.useEffect(()=>{const n=pe.current;if(!n)return;const d=()=>{const{scrollTop:x,scrollHeight:u,clientHeight:f}=n,b=x+f>=u-10;Ot(b)};return n.addEventListener("scroll",d),d(),()=>n.removeEventListener("scroll",d)},[i]);const Ie=()=>{oe.current?.scrollIntoView({behavior:"smooth"})};h.useEffect(()=>{typeof window>"u"||window.localStorage.setItem(Nt,D)},[D]),h.useEffect(()=>{if(!F.current)return;const n=F.current;n.style.height="auto";const d=200;n.style.height=`${Math.min(n.scrollHeight,d)}px`},[l]),h.useEffect(()=>{const n=p.trim();if(!n){M("idle"),T(""),ne(null);return}let d=!1;const x=new AbortController;return(async()=>{M("connecting"),T(""),ne(null);for(const f of Qs)try{const b=await fetch(`https://generativelanguage.googleapis.com/${f}/models/${encodeURIComponent(Zs)}?key=${encodeURIComponent(n)}`,{signal:x.signal});if(!b.ok){const E=await b.json().catch(()=>({})),j=E?.error?.message||"Unable to verify access code";if(b.status===404||E?.error?.status==="NOT_FOUND")continue;throw new Error(j)}if(d)return;M("connected"),T(""),ne(f);return}catch{if(x.signal.aborted||d)return;break}M("idle"),T(""),ne(null)})(),()=>{d=!0,x.abort()}},[p]);const $t=()=>{const n=I.trim();if(!n){e("Please enter a valid access code","error");return}typeof window<"u"&&window.localStorage.setItem("gemini_api_key",n),g(!0),N(n),S(""),M("connecting"),T(""),_(!1),e("Personal access code saved. Connecting now...","success")},Ht=()=>{typeof window<"u"&&window.localStorage.removeItem("gemini_api_key");const n=fe||"";g(!1),S(""),N(n),M(n?"connecting":"idle"),T(""),e(n?"Reverted to the built-in HHS access code.":"Access code removed. Running in local knowledge mode.","info")},Gt=n=>{const d=n.toLowerCase();return Ws.find(x=>x.keywords.some(u=>d.includes(u)))},ge=async n=>{if(n)try{if(typeof navigator>"u"||!navigator.clipboard)throw new Error("Clipboard unavailable");await navigator.clipboard.writeText(n),e("Message copied to clipboard","success")}catch(d){console.error("Copy failed",d),e("Unable to copy message","error")}},_e=()=>{confirm("Clear this conversation and start fresh?")&&(r([ue()]),e("Conversation cleared","success"),Ie(),Se(null),q(null))},Ae=()=>{const n=i.filter(f=>!f.isSystem).map(f=>`${f.sender.toUpperCase()} (${V(f,!0)}):
${f.text}`).join(`

---

`),d=new Blob([n],{type:"text/plain"}),x=URL.createObjectURL(d),u=document.createElement("a");u.href=x,u.download=`power-bi-guru-chat-${new Date().toISOString().split("T")[0]}.txt`,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(x),e("Chat exported","success")},ke=n=>{c(n),F.current?.focus()},Ut=async()=>{if(!D.trim()){e("No notes to copy","info");return}try{await navigator.clipboard.writeText(D),e("Session notes copied","success")}catch(n){console.error("Copy notes failed",n),e("Unable to copy notes","error")}},Kt=()=>{D.trim()&&confirm("Clear session notes?")&&(me(""),e("Session notes cleared","success"))},Re=n=>{if(!Y||C||!k.current)return;n.preventDefault();const d=n.clientX,x=Ce,u=document.body.style.userSelect;document.body.style.userSelect="none";const f=E=>{const j=ie(),K=E.clientX-d,le=W(x-K,z,j);xe(le)},b=()=>{document.body.style.userSelect=u,window.removeEventListener("pointermove",f),window.removeEventListener("pointerup",b)};window.addEventListener("pointermove",f),window.addEventListener("pointerup",b)},Oe=n=>{if(!Y||C||!k.current||n.key!=="ArrowLeft"&&n.key!=="ArrowRight")return;n.preventDefault();const d=ie(),x=n.key==="ArrowLeft"?24:-24;xe(u=>W(u+x,z,d))},Me=()=>{Mt(n=>!n),typeof window<"u"&&requestAnimationFrame(()=>$())},Pt=()=>{Dt(n=>!n)},Te=()=>{Lt(n=>!n)},be=n=>{n&&(me(d=>`${d?`${d}

`:""}${n}`),e("Saved to session notes","success"))},V=(n,d=!1)=>{if(n.isSystem&&n.id==="welcome"&&!d)return"";const x=n.createdAt||(typeof n.id=="number"?new Date(n.id).toISOString():null),u=x?new Date(x):d?new Date:null;return u?u.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):""},De=G?"space-y-2":"space-y-4",Le=G?"p-3 text-[13px]":"p-4 text-sm",$e=G?"text-[10px]":"text-xs",Bt=(n,d)=>{const[x,u]=h.useState(d?"":n);return h.useEffect(()=>{if(!d){u(n);return}let f=0;const b=setInterval(()=>{if(f>=n.length){clearInterval(b),u(n);return}const j=n.length>1e3?50:n.length>500?25:10;u(n.slice(0,f+j)),f+=j},10);return()=>clearInterval(b)},[n,d]),x},He=({text:n,shouldAnimate:d})=>{const x=Bt(n,d);if(!x)return t.jsx("span",{className:"animate-pulse",children:"..."});const u=x.split(/(```[\s\S]*?```)/g);return t.jsx("div",{className:`whitespace-pre-wrap leading-relaxed ${G?"text-[13px]":"text-sm"}`,children:u.map((f,b)=>{if(f.startsWith("```")&&f.endsWith("```")){const E=f.match(/^```(\w+)?\n([\s\S]*)```$/),j=E?E[1]:"",K=E?E[2]:f.slice(3,-3);return t.jsxs("div",{className:"my-3 rounded-lg bg-slate-800 text-slate-100 overflow-hidden shadow-sm border border-slate-700",children:[t.jsxs("div",{className:"flex items-center justify-between px-3 py-1.5 bg-slate-900/50 text-xs text-slate-400 border-b border-white/10 select-none",children:[t.jsx("span",{className:"uppercase font-semibold tracking-wider text-[10px]",children:j||"CODE"}),t.jsxs("button",{onClick:le=>{le.stopPropagation(),ge(K.trim())},className:"hover:text-white flex items-center gap-1.5 transition-colors","aria-label":"Copy code",children:[t.jsx(de,{className:"h-3 w-3"})," Copy"]})]}),t.jsx("pre",{className:"p-3 overflow-x-auto font-mono text-xs sm:text-sm scrollbar-thin scrollbar-thumb-slate-600 scrollbar-track-transparent",children:t.jsx("code",{children:K.trim()})})]},b)}return t.jsx("span",{children:f},b)})})},re=async()=>{if(!l.trim())return;const n={id:Date.now(),text:l,sender:"user",createdAt:new Date().toISOString()};r(u=>[...u,n]),c(""),te(!0),Se({id:n.id,text:n.text});const d=Gt(n.text);if(d){setTimeout(()=>{const u={id:Date.now()+1,text:d.answer,sender:"bot",link:d.link,createdAt:new Date().toISOString()};r(f=>[...f,u]),q(u.id),te(!1)},600);return}const x=p.trim();if(x){try{const u=new zs(x);let f,b;for(const A of At)try{f=u.getGenerativeModel({model:A,systemInstruction:"You are an expert Power BI Developer and Data Analyst for the US Department of Health and Human Services (HHS). Answer questions concisely and professionally. If it involves DAX, provide code snippets."});break}catch(Yt){b=Yt;continue}if(!f)throw b||new Error("No compatible Gemini model found");const j=[...i.filter(A=>!A.isError&&!A.isSystem).map(A=>({role:A.sender==="user"?"user":"model",parts:[{text:A.text}]})),{role:"user",parts:[{text:n.text}]}],Ft=(await(await f.generateContent({contents:j,generationConfig:{maxOutputTokens:1e3}})).response).text(),Be={id:Date.now()+1,text:Ft,sender:"bot",createdAt:new Date().toISOString()};r(A=>[...A,Be]),q(Be.id)}catch(u){console.error("AI Connection Error:",u.message);const f=u.message?.includes("API_KEY")||u.message?.includes("PERMISSION_DENIED")||u.message?.includes("INVALID_ARGUMENT");f&&(M("error"),T("Invalid API key or insufficient permissions"));const b={id:Date.now()+1,text:f?"I couldn't connect to the AI service with the current access code. Please update your API key in settings, or I can help with local knowledge about DAX and Power BI.":"I'm having trouble connecting to the AI service right now. Let me help with what I know about DAX and Power BI instead.",sender:"bot",isError:!0,createdAt:new Date().toISOString()};r(E=>[...E,b]),q(b.id)}finally{te(!1)}return}setTimeout(()=>{const u={id:Date.now()+1,text:"I don't have an answer for that in my local knowledge base. To unlock full AI capabilities, please configure the AI Access Code in settings.",sender:"bot",isSystem:!0,createdAt:new Date().toISOString()};r(f=>[...f,u]),q(u.id),te(!1)},600)},Ge=!!fe,U=p?se==="connected"?{text:Ne?`AI Connected (${Ne})`:"AI Connected",className:"bg-emerald-100 text-emerald-700"}:se==="connecting"?{text:"Verifying Access Code",className:"bg-sky-100 text-sky-700"}:se==="error"?{text:"Connection Error",className:"bg-rose-100 text-rose-700"}:null:null,Ue=!C,Ke=Y?{width:`${Ce}px`}:void 0,Pe=t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center justify-between mb-3 gap-2",children:[t.jsxs("div",{children:[t.jsxs("p",{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:[t.jsx(us,{className:"h-4 w-4 text-brand-500"}),"Session Notes"]}),t.jsx("p",{className:"text-xs text-slate-500",children:"Capture insights or follow-ups"})]}),t.jsxs("div",{className:"flex gap-1",children:[t.jsx("button",{onClick:Ut,className:"p-2 text-slate-400 hover:text-brand-600 hover:bg-brand-50 rounded transition-colors",title:"Copy notes","aria-label":"Copy notes",children:t.jsx(de,{className:"h-4 w-4"})}),t.jsx("button",{onClick:Kt,className:"p-2 text-slate-400 hover:text-rose-600 hover:bg-rose-50 rounded transition-colors",title:"Clear notes","aria-label":"Clear notes",children:t.jsx(ss,{className:"h-4 w-4"})})]})]}),t.jsx("textarea",{value:D,onChange:n=>me(n.target.value),placeholder:"Capture project context, action items, or next steps...",className:"input-field flex-1 min-h-[200px] resize-none"}),t.jsxs("p",{className:"text-[11px] text-slate-400 text-right mt-2",children:["Autosaved locally • ",D.trim().length," chars"]})]});return Ee?t.jsxs("div",{className:"fixed inset-0 z-50 bg-white flex flex-col",children:[t.jsxs("div",{className:"bg-slate-50 border-b border-slate-200 px-4 py-3 flex flex-wrap items-center justify-between gap-3",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Fe,{className:"h-5 w-5 text-brand-600"}),t.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Power BI Guru"}),U&&t.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full font-medium ${U.className}`,children:U.text})]}),t.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[t.jsxs("button",{onClick:o,"aria-pressed":s,"aria-label":s?"Show sidebar":"Hide sidebar",className:`hidden lg:flex p-2 rounded-lg text-sm font-medium items-center gap-2 border transition-colors ${s?"border-slate-200 text-slate-600 hover:bg-slate-100":"bg-emerald-50 text-emerald-700 border-emerald-100"}`,title:s?"Show sidebar":"Hide sidebar",children:[s?t.jsx(Ze,{className:"h-4 w-4"}):t.jsx(Qe,{className:"h-4 w-4"}),t.jsx("span",{className:"hidden xl:inline",children:s?"Show sidebar":"Hide sidebar"})]}),t.jsxs("button",{onClick:Me,"aria-pressed":!C,"aria-label":C?"Show notes panel":"Hide notes panel",className:`p-2 rounded-lg text-sm font-medium flex items-center gap-2 border transition-colors ${C?"border-slate-200 text-slate-600 hover:bg-slate-100":"bg-brand-50 text-brand-700 border-brand-100"}`,children:[C?t.jsx(tt,{className:"h-4 w-4"}):t.jsx(et,{className:"h-4 w-4"}),t.jsx("span",{className:"hidden sm:inline",children:C?"Show notes":"Hide notes"})]}),t.jsx("button",{onClick:Te,className:"p-2 hover:bg-slate-200 rounded-lg transition-colors text-slate-600",title:"Exit Fullscreen",children:t.jsx(cs,{className:"h-5 w-5"})})]})]}),t.jsx("div",{className:"flex-1 flex flex-col overflow-hidden",children:t.jsxs("div",{ref:k,className:"flex-1 flex flex-col gap-4 lg:flex-row lg:items-stretch px-4 pb-4 pt-2 overflow-hidden",children:[t.jsxs("div",{className:"flex-1 flex flex-col min-w-0 bg-white relative border border-slate-200 rounded-xl shadow-sm",children:[t.jsxs("div",{className:"px-4 py-2 border-b border-slate-100 bg-white flex items-center gap-2 overflow-x-auto shrink-0",children:[t.jsxs("div",{className:"flex items-center gap-2 text-xs font-semibold uppercase text-slate-500 whitespace-nowrap",children:[t.jsx(st,{className:"h-3 w-3 text-brand-500"}),"Quick prompts"]}),t.jsx("div",{className:"flex gap-2",children:vt.map(n=>t.jsx("button",{onClick:()=>ke(n.value),className:"flex-shrink-0 px-3 py-1 text-xs bg-slate-100 text-slate-700 rounded-full hover:bg-brand-50 hover:text-brand-700 transition-colors whitespace-nowrap",children:n.label},n.label))}),t.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[t.jsx("button",{onClick:Ae,className:"p-1.5 text-slate-400 hover:text-slate-600 hover:bg-slate-200 rounded transition-colors",title:"Export chat","aria-label":"Export chat",children:t.jsx(Ve,{className:"h-4 w-4"})}),t.jsx("button",{onClick:_e,className:"p-1.5 text-slate-400 hover:text-red-500 hover:bg-red-50 rounded transition-colors",title:"Clear chat","aria-label":"Clear chat",children:t.jsx(Ye,{className:"h-4 w-4"})})]})]}),t.jsxs("div",{ref:pe,className:`flex-1 overflow-y-auto p-4 md:p-8 ${De} relative`,children:[i.map(n=>t.jsx(P.div,{id:`message-${n.id}`,initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:`flex ${n.sender==="user"?"justify-end":"justify-start"}`,children:t.jsxs("div",{className:`max-w-[90%] md:max-w-[70%] rounded-2xl ${Le} group relative shadow-sm ${n.sender==="user"?"bg-brand-600 text-white rounded-br-none":n.isSystem?"bg-amber-50 text-amber-800 border border-amber-100":"bg-slate-100 text-slate-800 rounded-bl-none"} ${n.id===ae?"ring-2 ring-brand-200 shadow-brand-200/60":""}`,children:[t.jsx("button",{onClick:()=>ge(n.text),className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity text-slate-400 hover:text-brand-600 bg-white/20 p-1 rounded",title:"Copy message","aria-label":"Copy message",children:t.jsx(de,{className:"h-3 w-3"})}),n.sender==="bot"&&!n.isSystem&&t.jsx("button",{onClick:()=>be(n.text),className:"absolute top-2 right-12 opacity-0 group-hover:opacity-100 transition-opacity text-slate-400 hover:text-brand-600 bg-white/20 p-1 rounded",title:"Save to notes","aria-label":"Save to notes",children:t.jsx(ye,{className:"h-3 w-3"})}),t.jsxs("div",{className:`flex items-center justify-between mb-1 opacity-75 ${$e}`,children:[t.jsxs("div",{className:"flex items-center gap-2",children:[n.sender==="user"?t.jsx(qe,{className:"h-3 w-3"}):t.jsx(Xe,{className:"h-3 w-3"}),t.jsx("span",{className:"uppercase font-bold tracking-wider",children:n.sender})]}),V(n)&&t.jsx("span",{className:"opacity-75",children:V(n)})]}),t.jsx(He,{text:n.text,shouldAnimate:n.id===ae&&n.sender==="bot"&&!n.isSystem}),n.link&&t.jsx("div",{className:"mt-3 pt-3 border-t border-black/10",children:t.jsxs("a",{href:`#${n.link}`,className:"text-xs font-bold flex items-center gap-1 hover:underline",children:["View Resource ",t.jsx(ze,{className:"h-3 w-3"})]})})]})},n.id)),t.jsx(ce,{children:ee&&t.jsx(P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"flex justify-start",children:t.jsxs("div",{className:"bg-slate-100 rounded-2xl rounded-bl-none p-4 flex gap-1",children:[t.jsx("span",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce"}),t.jsx("span",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce delay-75"}),t.jsx("span",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce delay-150"})]})})}),t.jsx("div",{ref:oe})]}),t.jsxs("div",{className:"p-4 bg-slate-50 border-t border-slate-200 shrink-0",children:[t.jsxs("div",{className:"max-w-4xl mx-auto w-full flex gap-2",children:[t.jsx("textarea",{ref:F,value:l,onChange:n=>c(n.target.value),onKeyDown:n=>{n.key==="Enter"&&!n.shiftKey&&(n.preventDefault(),re())},placeholder:"Ask anything about Power BI... (Shift+Enter for new line)",className:"input-field flex-1 shadow-sm resize-none min-h-[48px] max-h-[200px]",rows:1}),t.jsx("button",{onClick:re,disabled:!l.trim()||ee,className:"btn-primary disabled:opacity-50 disabled:cursor-not-allowed px-6","aria-label":"Send message",children:t.jsx(We,{className:"h-5 w-5"})})]}),!p&&t.jsxs("p",{className:"text-xs text-slate-400 mt-2 text-center",children:["Running in ",t.jsx("span",{className:"font-semibold text-brand-600",children:"Local Knowledge Mode"}),". Add an Access Code for full AI features."]})]})]}),Ue&&t.jsxs("div",{className:"flex flex-col gap-4 lg:gap-0 lg:flex-row shrink-0 w-full lg:w-auto",children:[Y&&t.jsx("div",{className:"hidden lg:flex items-center justify-center w-5 cursor-col-resize select-none text-slate-400 hover:bg-slate-100 hover:text-brand-500 transition-colors -ml-2.5 z-10",role:"separator","aria-label":"Resize session notes panel","aria-orientation":"vertical",tabIndex:0,onPointerDown:Re,onKeyDown:Oe,title:"Drag to resize notes",children:t.jsx("div",{className:"flex flex-col items-center gap-1 bg-white/80 rounded-full px-1 py-3 shadow-sm border border-slate-200",children:t.jsx(Je,{className:"h-4 w-4"})})}),t.jsx("div",{className:"border border-slate-200 bg-slate-50 rounded-xl shadow-inner p-4 sm:p-5 flex flex-col w-full lg:w-auto transition-[width] duration-200",style:Ke,children:Pe})]})]})})]}):t.jsxs("div",{className:"flex flex-col gap-4 min-h-[calc(100vh-10rem)] sm:min-h-[calc(100vh-8rem)]",children:[t.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-3 mb-2 sm:mb-4",children:[t.jsxs("div",{children:[t.jsxs("h2",{className:"text-2xl font-bold text-slate-900 flex items-center gap-2",children:[t.jsx(Fe,{className:"h-6 w-6 text-brand-600"}),"Power BI Guru",U&&t.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full font-medium ${U.className}`,children:U.text})]}),t.jsx("p",{className:"text-slate-600",children:"Your AI assistant for DAX, Design, and Strategy."}),p&&t.jsx("p",{className:"mt-1 text-xs text-slate-500",children:m?"Using your personal Gemini access code.":Ge?"Using the built-in HHS Gemini access code.":"Using the currently stored Gemini access code."}),se==="error"&&p&&t.jsxs("p",{className:"mt-1 text-sm text-rose-600 flex items-center gap-1",children:[t.jsx(zt,{className:"h-4 w-4"}),t.jsx("span",{children:kt||"Unable to connect to the AI. Update the access code in settings."})]})]}),t.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[t.jsxs("button",{onClick:o,"aria-pressed":s,"aria-label":s?"Show sidebar":"Hide sidebar",className:`hidden lg:flex p-2 rounded-lg text-sm font-medium items-center gap-2 border transition-colors ${s?"border-slate-200 text-slate-600 hover:bg-slate-100":"bg-emerald-50 text-emerald-700 border-emerald-100"}`,title:s?"Show sidebar":"Hide sidebar",children:[s?t.jsx(Ze,{className:"h-4 w-4"}):t.jsx(Qe,{className:"h-4 w-4"}),t.jsx("span",{className:"hidden xl:inline",children:s?"Show sidebar":"Hide sidebar"})]}),t.jsxs("button",{onClick:Me,"aria-pressed":!C,"aria-label":C?"Show notes panel":"Hide notes panel",className:`p-2 rounded-lg text-sm font-medium flex items-center gap-2 border transition-colors ${C?"border-slate-200 text-slate-600 hover:bg-slate-100":"bg-brand-50 text-brand-700 border-brand-100"}`,children:[C?t.jsx(tt,{className:"h-4 w-4"}):t.jsx(et,{className:"h-4 w-4"}),t.jsx("span",{className:"hidden sm:inline",children:C?"Show notes":"Hide notes"})]}),t.jsx("button",{onClick:Te,className:"p-2 rounded-lg bg-slate-100 text-slate-600 hover:bg-slate-200 transition-colors",title:"Maximize (Fullscreen Mode)",children:t.jsx(as,{className:"h-5 w-5"})}),t.jsx("button",{onClick:()=>_(!y),className:`p-2 rounded-lg transition-colors ${y?"bg-brand-50 text-brand-700":m?"bg-emerald-100 text-emerald-700":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,title:"Manage AI Access Code",children:t.jsx(gs,{className:"h-5 w-5"})})]})]}),t.jsx(ce,{children:y&&t.jsx(P.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden mb-4",children:t.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-lg p-4",children:[t.jsxs("h3",{className:"font-semibold text-slate-900 mb-2 flex items-center gap-2",children:[t.jsx(Wt,{className:"h-4 w-4"})," AI Settings"]}),t.jsx("p",{className:"text-sm text-slate-600 mb-3",children:"Enter your access code to enable full AI chat capabilities."}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("input",{type:"password",value:I,onChange:n=>S(n.target.value),placeholder:"Enter Access Code...",className:"input-field flex-1"}),t.jsx("button",{onClick:$t,className:"btn-primary",children:"Save & Connect"}),m&&t.jsx("button",{onClick:Ht,className:"btn-secondary text-red-600 hover:bg-red-50",children:"Clear"})]}),t.jsxs("div",{className:"text-xs text-slate-500 mt-3 space-y-1",children:[t.jsx("p",{children:m?"Currently using your personal Gemini key. Clear to switch back to the built-in HHS access code.":Ge?"Using the built-in HHS Gemini key by default. Add your own key if you need to run chats under a personal quota.":"No access code is configured yet. Add one to enable cloud AI responses."}),t.jsx("p",{className:"text-slate-400",children:"Any personal key you add stays in your browser only."})]})]})})}),t.jsxs("div",{ref:k,className:"flex-1 flex flex-col gap-4 lg:flex-row lg:items-stretch overflow-hidden",children:[t.jsxs("div",{className:"flex-1 bg-white border border-slate-200 rounded-xl shadow-sm overflow-hidden flex flex-col relative min-w-0 min-h-[420px]",children:[t.jsxs("div",{className:"bg-slate-50 border-b border-slate-200 px-3 sm:px-4 py-2 sm:py-3 flex flex-wrap items-center gap-3",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(rs,{className:"h-4 w-4 text-slate-500"}),t.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Conversation"}),t.jsxs("span",{className:"text-xs text-slate-500 bg-slate-200 px-2 py-0.5 rounded-full",children:[i.filter(n=>!n.isSystem).length," messages"]})]}),t.jsxs("div",{className:"flex gap-1.5 sm:gap-2 ml-auto",children:[t.jsx("button",{onClick:Ae,className:"p-1.5 text-slate-400 hover:text-slate-600 hover:bg-slate-200 rounded transition-colors",title:"Export chat",children:t.jsx(Ve,{className:"h-4 w-4"})}),t.jsx("button",{onClick:_e,className:"p-1.5 text-slate-400 hover:text-red-500 hover:bg-red-50 rounded transition-colors",title:"Clear chat",children:t.jsx(Ye,{className:"h-4 w-4"})})]})]}),t.jsxs("div",{className:"px-3 sm:px-4 py-2 sm:py-3 border-b border-slate-100 bg-white flex flex-wrap items-center gap-2",children:[t.jsxs("div",{className:"flex items-center gap-2 text-xs font-semibold uppercase text-slate-500",children:[t.jsx(st,{className:"h-3 w-3 text-brand-500"}),"Quick prompts"]}),t.jsx("div",{className:"flex flex-wrap gap-2",children:vt.map(n=>t.jsx("button",{onClick:()=>ke(n.value),className:"px-3 py-1 text-xs bg-slate-100 text-slate-700 rounded-full hover:bg-brand-50 hover:text-brand-700 transition-colors",children:n.label},n.label))}),t.jsx("button",{onClick:Pt,className:`ml-auto text-xs px-3 py-1 rounded-full border ${G?"bg-brand-600 text-white border-brand-600":"border-slate-200 text-slate-600"}`,children:G?"Compact mode on":"Compact mode off"})]}),L&&t.jsxs("div",{className:"px-3 sm:px-4 py-2 sm:py-3 border-b border-slate-100 bg-slate-50 flex flex-wrap items-center gap-3",children:[t.jsxs("div",{className:"flex-1 min-w-[240px]",children:[t.jsx("p",{className:"text-xs uppercase font-semibold text-slate-500 tracking-wide",children:"Current question"}),t.jsx("p",{className:"font-medium text-slate-900",children:sn(L.text,160)})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("button",{onClick:()=>je(L.id),className:"px-3 py-1.5 text-xs rounded-full bg-white border border-slate-200 hover:border-brand-300 hover:text-brand-600 transition-colors flex items-center gap-1",children:[t.jsx(Qt,{className:"h-3 w-3"})," Jump to question"]}),t.jsxs("button",{onClick:()=>be(L.text),className:"px-3 py-1.5 text-xs rounded-full bg-brand-50 text-brand-700 border border-brand-100 flex items-center gap-1",children:[t.jsx(ye,{className:"h-3 w-3"})," Save"]})]})]}),t.jsxs("div",{ref:pe,className:`flex-1 overflow-y-auto p-3 sm:p-4 lg:p-5 ${De} relative`,children:[i.map(n=>t.jsx(P.div,{id:`message-${n.id}`,initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:`flex ${n.sender==="user"?"justify-end":"justify-start"}`,children:t.jsxs("div",{className:`max-w-[80%] rounded-2xl ${Le} group relative ${n.sender==="user"?"bg-brand-600 text-white rounded-br-none":n.isSystem?"bg-amber-50 text-amber-800 border border-amber-100":"bg-slate-100 text-slate-800 rounded-bl-none"} ${n.id===ae?"ring-2 ring-brand-200 shadow-lg shadow-brand-200/60":""}`,children:[t.jsx("button",{onClick:()=>ge(n.text),className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity text-slate-400 hover:text-brand-600",title:"Copy message","aria-label":"Copy message",children:t.jsx(de,{className:"h-4 w-4"})}),n.sender==="bot"&&!n.isSystem&&t.jsx("button",{onClick:()=>be(n.text),className:"absolute top-2 right-10 opacity-0 group-hover:opacity-100 transition-opacity text-slate-400 hover:text-brand-600",title:"Save to notes","aria-label":"Save to notes",children:t.jsx(ye,{className:"h-4 w-4"})}),t.jsxs("div",{className:`flex items-center justify-between mb-1 opacity-75 ${$e}`,children:[t.jsxs("div",{className:"flex items-center gap-2",children:[n.sender==="user"?t.jsx(qe,{className:"h-3 w-3"}):t.jsx(Xe,{className:"h-3 w-3"}),t.jsx("span",{className:"uppercase font-bold tracking-wider",children:n.sender})]}),V(n)&&t.jsx("span",{className:"text-slate-400",children:V(n)})]}),t.jsx(He,{text:n.text,shouldAnimate:n.id===ae&&n.sender==="bot"&&!n.isSystem}),n.link&&t.jsx("div",{className:"mt-3 pt-3 border-t border-black/10",children:t.jsxs("a",{href:`#${n.link}`,className:"text-xs font-bold flex items-center gap-1 hover:underline",children:["View Resource ",t.jsx(ze,{className:"h-3 w-3"})]})})]})},n.id)),t.jsx(ce,{children:ee&&t.jsx(P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"flex justify-start",children:t.jsxs("div",{className:"bg-slate-100 rounded-2xl rounded-bl-none p-4 flex gap-1",children:[t.jsx("span",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce"}),t.jsx("span",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce delay-75"}),t.jsx("span",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce delay-150"})]})})}),t.jsx("div",{ref:oe})]}),t.jsx(ce,{children:!Rt&&t.jsx(P.button,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},onClick:Ie,className:"absolute bottom-24 right-4 bg-brand-600 text-white p-2 rounded-full shadow-lg hover:bg-brand-700 transition-colors z-10",title:"Scroll to bottom",children:t.jsx(Xt,{className:"h-4 w-4"})})}),t.jsxs("div",{className:"p-3 sm:p-4 bg-slate-50 border-t border-slate-200",children:[t.jsxs("div",{className:"flex gap-2",children:[t.jsx("textarea",{ref:F,value:l,onChange:n=>c(n.target.value),onKeyDown:n=>{n.key==="Enter"&&!n.shiftKey&&(n.preventDefault(),re())},placeholder:"Ask anything about Power BI... (Shift+Enter for new line)",className:"input-field flex-1 shadow-sm resize-none min-h-[48px] max-h-[200px]",rows:1}),t.jsx("button",{onClick:re,disabled:!l.trim()||ee,className:"btn-primary disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Send message",children:t.jsx(We,{className:"h-4 w-4"})})]}),t.jsxs("p",{className:"text-xs text-slate-400 mt-2 text-center flex flex-wrap items-center justify-center gap-2",children:[t.jsx("span",{children:"Enter = Send"}),t.jsx("span",{children:"Shift+Enter = New line"}),t.jsx("span",{children:"Copy buttons appear when you hover a message"})]}),!p&&t.jsxs("p",{className:"text-xs text-slate-400 mt-2 text-center",children:["Running in ",t.jsx("span",{className:"font-semibold text-brand-600",children:"Local Knowledge Mode"}),". Add an Access Code for full AI features."]})]})]}),Ue&&t.jsxs("div",{className:"flex flex-col gap-4 lg:gap-0 lg:flex-row shrink-0 w-full lg:w-auto",children:[Y&&t.jsx("div",{className:"hidden lg:flex items-center justify-center w-5 cursor-col-resize select-none text-slate-400 hover:bg-slate-100 hover:text-brand-500 transition-colors -ml-2.5 z-10",role:"separator","aria-label":"Resize session notes panel","aria-orientation":"vertical",tabIndex:0,onPointerDown:Re,onKeyDown:Oe,title:"Drag to resize notes",children:t.jsx("div",{className:"flex flex-col items-center gap-1 bg-white/80 rounded-full px-1 py-3 shadow-sm border border-slate-200",children:t.jsx(Je,{className:"h-4 w-4"})})}),t.jsx("aside",{className:"bg-white border border-slate-200 rounded-xl shadow-sm p-4 sm:p-5 flex flex-col w-full lg:w-auto min-h-[260px] transition-[width] duration-200",style:Ke,children:Pe})]})]})]})};export{dn as default};
